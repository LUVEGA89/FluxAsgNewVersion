@{
    ViewBag.Title = "Precios";
}
@model Reporting.Service.Web.UI.Models.Producto
<style>
    #reference-table {
        z-index: 99;
        display: none;
        right: 0px;
        position: absolute;
        height: auto;
    }

    .direct-chat-messages {
        -webkit-transform: translate(0, 0);
        -ms-transform: translate(0, 0);
        -o-transform: translate(0, 0);
        transform: translate(0, 0);
        padding: 10px;
        height: 500px;
        overflow: auto;
    }
    /*
        #reference-table{
        z-index:99;
        width:auto;
        height:auto;
        display:none;
        position:absolute;
        left:auto;
        right:auto;
        top:0 auto;
    }

    .reference-table {
        border-style: solid;
        border-width: 5px;
    }
    */
</style>
<section class="content-header">
    <h1>
        Productos
        <small>Gestión de precios</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Productos </a></li>
        <li class="active"> Precios</li>
        <li class="active">APG</li>
    </ol>
</section>
<section class="content">

    <div class="row">
        <!--------------------------Caja de Referencias Tipo chat------------------------------------>
        <div class="col-md-3" id="reference-table">
            <div class="box box-danger direct-chat direct-chat-danger">
                <div class="box-header with-border">
                    <h3 class="box-title">Busqueda de referencias</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <!--<button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>-->
                    </div>
                </div>
                <div class="box-body">
                    <div class="direct-chat-messages">
                        <div class="direct-chat-msg">
                            <div class="box box-custom">
                                <table class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th style="width: 10px">SKU</th>
                                            <th style="width: 30px">LISTA</th>
                                            <th style="width: 20px">PRECIOS CON IVA</th>
                                        </tr>
                                    </thead>
                                    <tbody id="table-search-reference"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box-footer">
                    <form action="#" method="post">
                        <div class="input-group">
                            <input name="message" placeholder="Referencia ..." class="form-control" id="txt-search-reference" type="text">
                            <span class="input-group-btn">
                                <button type="submit" class="btn btn-success btn-flat" id="btn-search-reference">Buscar</button>
                            </span>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!------------------------Primer caja para modificacion de precios--------------------------->
        <div class="col-md-12">

            <div class="box box-danger">
                <div class="box-header">
                    <i class="fa fa-level-down"></i>
                    <h3 class="box-title">Precios SAP</h3>
                    <div class="box-tools pull-right">
                        <button id="btn-DetalleSku" type="button" class="btn btn-box-tool"><i class="fa fa-file-excel-o"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="table-responsive">
                                <!-----------------------------------Tabla de Precios------------------------------>
                                <table id="busca-precios" class="table table-bordered busca-precios-class">
                                    <thead>
                                        <tr>
                                            <!-------------------Botones de busqueda-------------------->
                                            <th colspan="7" style="background-color: #d4d4d4;">
                                                <input type="text" id="ItemCode" class="form-control" placeholder="Ingresa el SKU">
                                                <div class="btn-group">
                                                    <button type="button" class="btn btn-info" data-toggle='modal' href='#myModal2'>Familia</button>
                                                    <button type="button" class="btn btn-primary" id="click-buscar">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Buscar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>
                                                    <button type="button" class="click btn btn-info">Referencia</button>
                                                </div>
                                            </th>


                                            <!-------------------Grupo de cabeceras-------------------->
                                            <th colspan="3" class="thlpp1">SAP 40<br /> ULTRA</th>
                                            <th colspan="2" class="colorefxhp">SAP 39 PREMIUM</th>
                                            <th colspan="2" class="thlpp1">SAP 38 EXCELENCIA</th>
                                            <th colspan="3" class="colorefxhp">SAP 15 (FR)</th>
                                            <th colspan="3" class="thlpp1">SAP 6<br />Retail A</th>
                                            <th colspan="3" class="colorefxhp">SAP 3 <br />Retail AA</th>
                                            <th colspan="3" class="thlpp1">SAP 2<br />Retail AAA</th>
                                            <th colspan="4" class="colorefxhp">Mayoreo Tiendas Locales 33</th>
                                            <th colspan="4" class="thlpp1">Mayoreo Foraneas 25</th>
                                            <th colspan="4" class="colorefxhp">Publico Suc 14</th>
                                            <th colspan="4" class="thlpp1">Mayoreo WEB 48</th>
                                            <th colspan="4" class="colorefxhp">Publico WEB 47</th>
                                            <th colspan="4" class="thlpp1">Mayoreo Franquicias 29</th>
                                            <th colspan="4" class="colorefxhp">Publico Franquicias 28</th>
                                            <th colspan="4" class="thlpp1">Distribuidor Local 22</th>
                                            <th colspan="4" class="colorefxhp">Distribuidor Foraneo 42</th>                                           

                                        </tr>
                                        <tr class="thlppc">
                                            <!-------------------Cabecera Busqueda(40)-------------------->
                                            <th class="colorefx">SKU</th>
                                            <th class="colorefx" style="width:300px;">Tipo Precio</th>
                                            <th class="colorefx" style="width:230px;">FAM SIAT</th>
                                            <th class="colorefx">PZS MAY</th>
                                            <th class="colorefx">PZS MAY COR</th>
                                            <th class="colorefx">CMex S/IVA (SAP 41)</th>
                                            <th class="colorefx">STGP S/IVA (SAP 10)</th>
                                            <!-------------------Cabecera SAP(40)------------------------>
                                            <th class='coloref'>S/I</th>
                                            <th class='coloref'>C/IVA</th>
                                            <th class='coloref'>MARGEN</th>
                                            <!-------------------Cabecera SAP 39(F2)--------------------->
                                            <th class='colorefxp'>S/I</th>
                                            <th class='colorefxp'>C/IVA</th>
                                            <!-------------------Cabecera SAP 38 (F1)-------------------->
                                            <th class='coloref'>S/I</th>
                                            <th class='coloref'>C/IVA</th>
                                            <!-------------------Cabecera SAP 15 (FR)-------------------->
                                            <th class='colorefxp'>S/I</th>
                                            <th class='colorefxp'>C/IVA</th>
                                            <th class='colorefxp'>MARGEN</th>
                                            <!-------------------Cabecera Retail A-------------------->
                                            <th class='coloref'>S/I</th>
                                            <th class='coloref'>C/IVA</th>
                                            <th class='coloref'>MARGEN</th>
                                            <!-------------------Cabecera Retail AA-------------------->
                                            <th class='colorefxp'>S/I</th>
                                            <th class='colorefxp'>C/IVA</th>
                                            <th class='colorefxp'>MARGEN</th>
                                            <!-------------------Cabecera Retail AAA-------------------->
                                            <th class='coloref'>S/I</th>
                                            <th class='coloref'>C/IVA</th>
                                            <th class='coloref'>MARGEN</th>
                                            <!-------------------Mayoreo Tiendas Locales 33--------------->
                                            <th class='colorefxp'>P. Minimo</th>
                                            <th class='colorefxp'>S/I</th>
                                            <th class='colorefxp'>C/IVA</th>
                                            <th class='colorefxp'>MARGEN VS STGP</th>
                                            <!-------------------Mayoreo Foraneas 25--------------------->
                                            <th class='coloref'>P. Minimo</th>
                                            <th class="coloref">S/I</th>
                                            <th class="coloref">C/IVA</th>
                                            <th class="coloref">MARGEN VS STGP</th>
                                            <!-------------------Mayoreo Publico Suc 14------------------>
                                            <th class='colorefxp'>P. Minimo</th>
                                            <th class='colorefxp'>S/I</th>
                                            <th class='colorefxp'>C/IVA</th>
                                            <th class='colorefxp'>MARGEN VS STGP</th>
                                            <!-------------------Mayoreo WEB 48-------------------------->
                                            <th class='coloref'>P. Minimo</th>
                                            <th class="coloref">S/I</th>
                                            <th class="coloref">C/IVA</th>
                                            <th class="coloref">MARGEN VS FRN</th>
                                            <!-------------------Publico WEB 47-------------------------->
                                            <th class='colorefxp'>P. Minimo</th>
                                            <th class='colorefxp'>S/I</th>
                                            <th class='colorefxp'>C/IVA</th>
                                            <th class='colorefxp'>MARGEN VS FRN</th>
                                            <!-------------------Mayoreo Franquicias 29------------------>
                                            <th class='coloref'>P. Minimo</th>
                                            <th class="coloref">S/I</th>
                                            <th class="coloref">C/IVA</th>
                                            <th class="coloref">MARGEN VS FRN</th>
                                            <!-------------------Publico Franquicias 28------------------>
                                            <th class='colorefxp'>P. Minimo</th>
                                            <th class='colorefxp'>S/I</th>
                                            <th class='colorefxp'>C/IVA</th>
                                            <th class='colorefxp'>MARGEN VS FRN</th>
                                            <!-------------------Distribuidor 22--------------->
                                            <th class='coloref'>P. Minimo</th>
                                            <th class='coloref'>S/I</th>
                                            <th class='coloref'>C/IVA</th>
                                            <th class='coloref'>MARGEN VS STGP</th>
                                            <!-------------------Distribuidor 42--------------->
                                            <th class='colorefxp'>P. Minimo</th>
                                            <th class='colorefxp'>S/I</th>
                                            <th class='colorefxp'>C/IVA</th>
                                            <th class='colorefxp'>MARGEN VS STGP</th>
                                        </tr>
                                    </thead>
                                    <tbody id="detalle-lista-precios"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div id="cargandoPrecios" style="display:none;" class="overlay">
                        <i class="fa fa fa-refresh fa-spin"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!------------------------------Lista de precios modificados--------------------------------->
    <div class="box box-danger">
        <div class="box-header">
            <i class="fa fa-level-down"></i>
            <h3 class="box-title">Lista de precios modificados</h3>
            <div style="right: 81px;" class="box-tools ">
                <div class="form-inline">
                    <div class="form-group" style="display:none;">
                        <div class="input-group">
                            <div class="input-group-addon">
                                <i class="glyphicon glyphicon-calendar"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse">
                    <i class="fa fa-minus"></i>
                </button>
                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
            </div>
        </div>
        <div class="box-body" style="display: block;">
            <div class="table-responsive">
                <!-----------------------------------Tabla de Precios Modificados------------------------------>
                <table id="precios-modificados-all" class="table table-bordered stripe hover order-column row-border">
                    <thead>
                        <tr>
                            <!-------------------Grupo de cabeceras Azules-------------------->
                            <th rowspan="2" class="aprovate-fields">Estatus</th>
                            <th rowspan="2" class="aprovate-fields">SKU</th>
                            <th rowspan="2" class="aprovate-fields">Comentario</th>
                            <th rowspan="2" class="aprovate-fields">Familia</th>
                            <th rowspan="2" class="aprovate-fields">May Des</th>
                            <th rowspan="2" class="aprovate-fields">May Dis</th>
                            <!-------------------Grupo de cabeceras Roja/gris-------------------->
                            <th colspan="2" class="thlpp1">CMex 41</th>
                            <th colspan="2" class="colorefxhp">SAP 10</th>
                            <th colspan="2" class="thlpp1">SAP 40 <br />ULTRA</th>
                            <th colspan="2" class="colorefxhp">SAP 39 PREMIUM</th>
                            <th colspan="2" class="thlpp1">SAP 38 EXCELENCIA</th>
                            <th colspan="2" class="colorefxhp">SAP 15</th>
                            <th colspan="2" class="thlpp1">SAP 6 <br /> Retail A</th>
                            <th colspan="2" class="colorefxhp">SAP 3 <br /> Retail AA</th>
                            <th colspan="2" class="thlpp1">SAP 2 <br /> Retail AAA</th>
                            <th colspan="2" class="colorefxhp">Mayoreo Tiendas Locales 33</th>
                            <th colspan="2" class="thlpp1">Mayoreo Foraneas 25</th>
                            <th colspan="2" class="colorefxhp">Publico Suc 14</th>
                            <th colspan="2" class="thlpp1">Mayoreo WEB 48</th>
                            <th colspan="2" class="colorefxhp">Publico WEB 47</th>
                            <th colspan="2" class="thlpp1">Mayoreo Franquicias 29</th>
                            <th colspan="2" class="colorefxhp">Publico Franquicias 28</th>
                            <th colspan="2" class="thlpp1">Distribuidor Local 22</th>
                            <th colspan="2" class="colorefxhp">Distribuidor Foraneo 42</th>
                            <th rowspan="2" class="thlpp1">Fecha Modificación</th>
                        </tr>
                        <tr class="thlppc">
                            <!-------------------CMex 41-------------------->
                            <th class="thlpp">SAP</th>
                            <th class="thlpp">PRO</th>
                            <!-------------------SAP 10--------------------->
                            <th class="colorefxp">SAP</th>
                            <th class="colorefxp">PRO</th>
                            <!-------------------SAP 40--------------------->
                            <th class="thlpp">SAP</th>
                            <th class="thlpp">PRO</th>
                            <!-------------------SAP 39--------------------->
                            <th class="colorefxp">SAP</th>
                            <th class="colorefxp">PRO</th>
                            <!-------------------SAP 38--------------------->
                            <th class="thlpp">SAP</th>
                            <th class="thlpp">PRO</th>
                            <!-------------------SAP 15--------------------->
                            <th class="colorefxp">SAP</th>
                            <th class="colorefxp">PRO</th>
                            <!-------------------SAP 3--------------------->
                            <th class="thlpp">SAP</th>
                            <th class="thlpp">PRO</th>
                            <!-------------------SAP 6--------------------->
                            <th class="colorefxp">SAP</th>
                            <th class="colorefxp">PRO</th>
                            <!-------------------SAP 2--------------------->
                            <th class="thlpp">SAP</th>
                            <th class="thlpp">PRO</th>
                            <!---------Mayoreo Tiendas Locales 33----------->
                            <th class="colorefxp">SAP</th>
                            <th class="colorefxp">PRO</th>
                            <!-----------Mayoreo Foraneas 25---------------->
                            <th class="thlpp">SAP</th>
                            <th class="thlpp">PRO</th>
                            <!---------------Publico Suc 14------------------>
                            <th class="colorefxp">SAP</th>
                            <th class="colorefxp">PRO</th>
                            <!---------------Mayoreo WEB 48------------------>
                            <th class="thlpp">SAP</th>
                            <th class="thlpp">PRO</th>
                            <!-----------------Publico WEB 47---------------->
                            <th class="colorefxp">SAP</th>
                            <th class="colorefxp">PRO</th>
                            <!------------Mayoreo Franquicias 29------------->
                            <th class="thlpp">SAP</th>
                            <th class="thlpp">PRO</th>
                            <!-------------Publico Franquicias 28------------>
                            <th class="colorefxp">SAP</th>
                            <th class="colorefxp">PRO</th>
                            <!---------Distribuidor Locales 22----------->
                            <th class="thlpp">SAP</th>
                            <th class="thlpp">PRO</th>
                            <!---------Distribuidor Locales 42----------->
                            <th class="colorefxp">SAP</th>
                            <th class="colorefxp">PRO</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class="clearfix"></div>
                <div class="form-group pull-left">
                    <div id="mandar-solicitud" class="btn btn-success btn-block">Mandar para su aprobación</div>
                </div>
            </div>
            <div id="cargandoModificados" style="display:none;" class="overlay">
                <i class="fa fa fa-refresh fa-spin"></i>
            </div>
        </div>
    </div>

    <div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Nueva Familia</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal" onsubmit="required()">
                        <div class="box-body">
                            <div class="form-group">
                                <label class="col-sm-2 control-label">Familia</label>
                                <div class="col-sm-10">
                                    <input class="form-control" id="input-familia" placeholder="Nombre" type="text" autocomplete="off" required />
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <div class="form-group">
                                <label class="col-sm-2 control-label">Piezas Mayoreo</label>
                                <div class="col-sm-10">
                                    <input class="form-control" id="input-mayoreo" placeholder="Mayoreo" type="number" onkeypress="return isNumberKey(event)" autocomplete="off" required />
                                </div>
                            </div>
                        </div>
                        <div class="box-body">
                            <div class="form-group">
                                <label class="col-sm-2 control-label">Piezas Mayoreo Corporativo</label>
                                <div class="col-sm-10">
                                    <input class="form-control" id="input-mayoreo-crpo" placeholder="Mayoreo Crpo" type="number" onkeypress="return isNumberKey(event)" autocomplete="off" required />
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="submit" id="insertar-familia" class="btn btn-primary pull-right">Nueva Familia</button>
                    <button type="button" class="btn btn-default pull-right" data-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>
    <!--------------------------------Modal asociar familia-------------------------------------->
    <div class="modal fade" id="myModalFamilia" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Asociar Familia</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal">
                        <div class="box-body">

                            <div class="form-group">
                                <label class="col-sm-2 control-label">Sku: </label>
                                <div class="col-sm-10">
                                    <input type="text" name="sku" id="Sku" class="form-control" value="" autocomplete="off" required disabled />
                                </div>
                            </div>
                            <div class="box-body">
                                <div class="input-group margin">
                                    <input class="form-control" type="text" placeholder="Familia" id="get-familia-manual">
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-success btn-flat" id="boton-familia-manual">Buscar</button>
                                    </span>
                                </div>
                                <div class="input-group margin">
                                    <label>Familias encontradas</label>
                                    <select multiple="" class="form-control" id="select-familia-manual"></select>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" id="asociar-familia" class="btn btn-primary pull-right">Asociar Familia</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <div style="display:none" id='correoUno'>
        <table id='tablaCorreoUno' style='text-align: center; font-family: arial, sans-serif; border-collapse: collapse; width: 100%;'>
            <thead>
                <tr style='border: 1px solid black; text-align: center; background-color: rgb(221, 75, 57); color:#FFFFFF'>
                    <th width="35%">SKU</th>
                    <th width="35%">Tipo de precio</th>
                    <th width="15%">ULTRA C/IVA</th>
                    <th width="15%">SGTP C/IVA</th>
                </tr>
            </thead>
            <tbody id='bodyCorreoUno'></tbody>
        </table>
    </div>
    <div style="display:none" id='correoDos'>
        <table id='tablaCorreoDos' style='text-align: center; font-family: arial, sans-serif; border-collapse: collapse; width: 100%;'>
            <thead>
                <tr style='border: 1px solid black; text-align: center; background-color: rgb(221, 75, 57); color:#FFFFFF'>
                    <th width="9%">SKU</th>
                    <th width="9%">Tipo de precio </th>
                    <th width="9%">Mayoreo Locales</th>
                    <th width="9%">Mayoreo Foraneas</th>
                    <th width="9%">Publico Sucursales</th>
                    <th width="9%">Mayoreo Web</th>
                    <th width="9%">Publico Web</th>
                    <th width="9%">Mayoreo Franquicia</th>
                    <th width="9%">Publico Franquicia</th>
                    <th width="9%">Distribuidor Local</th>
                    <th width="9%">Distribuidor Foraneo</th>
                </tr>
            </thead>
            <tbody id='bodyCorreoDos'></tbody>

        </table>
    </div>
    <div class="modal fade" id="modalOferta" style="font-size:12px;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button id="cerrarModal" type="button" class="close" data-dismiss="modal" aria-label="Close" >
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h3 style="text-align:center;">
                        Información de oferta
                        <small id="smallUbicacion"></small>
                    </h3>

                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="box box-danger" id="datosOferta" >
                            <div class="box-header with-border">
                                <h3 class="box-title"></h3>
                                
                            </div>
                            <div class="box-body">
                                <div class="row">
                                    <div class="col-md-2">
                                       

                                    </div>
                                    <div class="col-md-8">
                                        <input type="hidden" class="form-control pull-right" id="indexOferta">
                                        <input type="hidden" class="form-control pull-right" id="tipoPrecioAnteriorOferta">
                                        <div class="form-group">
                                            <label>Sku:</label>
                                            <div class="input-group">
                                                <div class="input-group-addon">
                                                    <i class="fa fa-cube"></i>
                                                </div>
                                                <input type="text" class="form-control pull-right" id="skuOferta" disabled>
                                            </div>
                                            <div class="radio">
                                                <label>
                                                    <input type="radio" name="optionsRadios" id="ofertaSKU" value="ofertaSKU">
                                                    Aplicar oferta solo a este SKU
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Familia:</label>
                                            <div class="input-group">
                                                <div class="input-group-addon">
                                                    <i class="fa fa-cubes"></i>
                                                </div>
                                                <input type="text" class="form-control pull-right" id="familiaOferta" disabled>
                                            </div>
                                            <div class="radio">
                                                <label>
                                                    <input type="radio" name="optionsRadios" id="ofertaFamilia" value="ofertaFamilia">
                                                    Aplicar a toda la familia
                                                </label>
                                            </div>
                                        </div>  
                                        <div class="form-group">
                                            <label>Periodo de oferta:</label>
                                            <div class="input-group">
                                                <div class="input-group-addon">
                                                    <i class="fa fa-calendar"></i>
                                                </div>
                                                <input type="text" class="form-control pull-right" id="fechasOferta">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>Comentario:</label>
                                            <div class="input-group">
                                                <div class="input-group-addon">
                                                    <i class="fa fa-commenting-o"></i>
                                                </div>
                                                <textarea type="text" class="form-control pull-right" id="comentarioOferta"></textarea>
                                            </div>
                                        </div>
                                        <div class="form-group">


                                        </div>

                                    </div>
                                    
                                </div>

                            </div>
                            <!-- /.box-body -->
                        </div>

                    </div>
                </div>
                <div class="box-footer">
                    <button type="button" class="btn btn-danger" data-widget="remove" id="botonCerrarModarlOferta" onclick="cerrarModalOferta()"  >Cancelar</button>
                    <button type="button" class="btn btn-success pull-right" id="guardarOferta" onclick="guardarOferta()">Aceptar</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>


</section>

<script type="text/javascript">
    var Rol = localStorage.getItem("Rol");
    var User = localStorage.getItem("UserEmail");
    onLoadPrecioModificados();
    //onLoadPreciosModificadosEmail();

   

    //arreglos para Regresar los SKu a Modificados cuando falla correo 
    var arregloIdModificadosCorreoUno = new Array();
    var arregloIdModificadosCorreoDos = new Array();

    //Busca la lista de precios por item code
    function myFunctionSearchReference() {
        let ItemCode = $('#txt-search-reference').val();
        $.post('@Url.Action("ListaPrecioBusquedasReferencia", "Precios")', {
            ItemCode
        }, function (data) {

            if (data != null && $.isArray(data.Context) ) {
                $("#table-search-reference").html('');

                $.each(data.Context, function (index, value) {
                    if (value.PriceList == 9) {
                        value.PriceList = 'Carta Factura'
                    }
                    if (value.PriceList == 15) {
                        value.PriceList = 'FRN';
                        let add_super = value.Price * 0.93;
                        value.Price = add_super * 1.16;
                    }
                    if (value.PriceList == 33) {
                        value.PriceList = 'Mayoreo Tiendas Locales';
                        value.Price = (value.Price * 1.16);
                    }
                    if (value.PriceList == 25) {
                        value.PriceList = 'Mayoreo Foraneas';
                        value.Price = (value.Price * 1.16);
                    }
                    if (value.PriceList == 14) {
                        value.PriceList = 'Publico Sucursales y Web';
                        value.Price = (value.Price * 1.16);
                    }
                    if (value.PriceList == 29) {
                        value.PriceList = 'Mayoreo Franquicias';
                        value.Price = (value.Price * 1.16);
                    }
                    if (value.PriceList == 28) {
                        value.PriceList = 'Publico Franquicias';
                        value.Price = (value.Price * 1.16);
                    }
                    $("#table-search-reference").append(
                        "<tr>\
                            <td class=''>"+value.ItemCode + "</td>\
                            <td class='lista-precio-"+index+"'>" + value.PriceList + "</td>\
                            <td>" + formatNumber.new(value.Price.toFixed(2), "$ ") + "</td>\
                         </tr>");

                });
            } else {
                swal("Error en la api: Busqueda por referencia");
            }
        });
    }
    //Busca la lista de precios por item code
    function myFunctionSearch() {

        if ($('#ItemCode').val() == "") {
            swal("Atención", "Ingresa un SKU", "warning");
            return;
        }
        let ItemCode = $('#ItemCode').val();
        //let User = localStorage.getItem("UserEmail");
        //Se muestra estado de carga al usuario
        $('#cargandoPrecios').show();

        $.post('@Url.Action("ListaPrecioBusquedas", "Precios")', {
            ItemCode
        }, function (data) {
            
            if (data != null && $.isArray(data.Context)) {

                if (data.Context.length == 0) {
                    $('#cargandoPrecios').hide();
                    swal("Atención","No se encontró registro de este SKU","warning")
                    return
                }
                
                $("#detalle-lista-precios").html('');
                $.each(data.Context, function (index, value) {
                    //Tabla para Rol Preios(Angel)
                    //Listas habilitadas: 41,10,40
                    if (Rol == 'Precios' || User == 'angel_garcia@fussionweb.com') {
                        $("#detalle-lista-precios").append(
                            
                            "<tr class='Listas' style='background:#cce6ff' id='tr-change-color-" + index + "'>\
                                <td ondblclick='showTr("+ index + ")'>" + value.ItemCode + "</td>\
                                <td>"+value.TipoPrecio + "</td >\
                                <td>" + value.FamSIAT + "</td>\
                                <td>" + value.PzaMay + "</td>\
                                <td>" + value.PzaMayCorp + "</td>\
                                <td class='wht'><input type='hidden' id='PrecioOriginalListaCMex-" + index + "' value='" + value.CMex.toFixed(3) +"' />$ " + formatNumber.new(value.CMex.toFixed(3)) + "</td>\
                                <td class='wht'><input type='hidden' id='PrecioOriginalSTGP10-" + index + "' value='" + value.STGP10.toFixed(3) +"' />$ " + formatNumber.new(value.STGP10.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista40-" + index + "' value='" + value.Lista40.toFixed(3) +"' />$ " + formatNumber.new(value.Lista40.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista40_iva-" + index + "' value='" + value.Lista40_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista40_iva.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalMbvsstgp_40-" + index + "' value='" + value.Mbvsstgp_40.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_40.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista39-" + index + "' value='" + value.Lista39.toFixed(3) +"' />$ " + formatNumber.new(value.Lista39.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista39_iva-" + index + "' value='" + value.Lista39_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista39_iva.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista38-" + index + "' value='" + value.Lista38.toFixed(3) +"' />$ " + formatNumber.new(value.Lista38.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista38_iva-" + index + "' value='" + value.Lista38_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista38_iva.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista15-" + index + "' value='" + value.Lista15.toFixed(3) +"' />$ " + formatNumber.new(value.Lista15.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista15_iva-" + index + "' value='" + value.Lista15_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista15_iva.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalMbvsstgp_15-" + index + "' value='" + value.Mbvsstgp_15.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_15.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista6-" + index + "' value='" + value.Lista6.toFixed(3) +"' />$ " + formatNumber.new(value.Lista6.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista6_iva-" + index + "' value='" + value.Lista6_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista6_iva.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalMbvsstgp_6-" + index + "' value='" + value.Mbvsstgp_6.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_6.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista3-" + index + "' value='" + value.Lista3.toFixed(3) +"' />$ " + formatNumber.new(value.Lista3.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista3_iva-" + index + "' value='" + value.Lista3_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista3_iva.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalMbvsstgp_3-" + index + "' value='" + value.Mbvsstgp_3.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_3.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista2-" + index + "' value='" + value.Lista2.toFixed(3) +"' />$ " + formatNumber.new(value.Lista2.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista2_iva-" + index + "' value='" + value.Lista2_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista2_iva.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalMbvsstgp_2-" + index + "' value='" + value.Mbvsstgp_2.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_2.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalPMin33-" + index + "' value='" + value.PMin33.toFixed(3) +"' />$ " + formatNumber.new(value.PMin33.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista33-" + index + "' value='" + value.Lista33.toFixed(3) +"' />$ " + formatNumber.new(value.Lista33.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista33_iva-" + index + "' value='" + value.Lista33_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista33_iva.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalMbvsstgp_33-" + index + "' value='" + value.Mbvsstgp_33.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_33.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalPMin25-" + index + "' value='" + value.PMin25.toFixed(3) +"' />$ " + formatNumber.new(value.PMin25.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista25-" + index + "' value='" + value.Lista25.toFixed(3) +"' />$ " + formatNumber.new(value.Lista25.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista25_iva-" + index + "' value='" + value.Lista25_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista25_iva.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalMbvsstgp_25-" + index + "' value='" + value.Mbvsstgp_25.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_25.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalPMin14-" + index + "' value='" + value.PMin14.toFixed(3) +"' />$ " + formatNumber.new(value.PMin14.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista14-" + index + "' value='" + value.Lista14.toFixed(3) +"' />$ " + formatNumber.new(value.Lista14.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista14_iva-" + index + "' value='" + value.Lista14_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista14_iva.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalMbvsstgp_14-" + index + "' value='" + value.Mbvsstgp_14.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_14.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalPMin48-" + index + "' value='" + value.PMin48.toFixed(3) +"' />$ " + formatNumber.new(value.PMin48.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista48-" + index + "' value='" + value.Lista48.toFixed(3) +"' />$ " + formatNumber.new(value.Lista48.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista48_iva-" + index + "' value='" + value.Lista48_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista48_iva.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalMbvsstgp_48-" + index + "' value='" + value.Mbvsstgp_48.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_48.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalPMin47-" + index + "' value='" + value.PMin47.toFixed(3) +"' />$ " + formatNumber.new(value.PMin47.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista47-" + index + "' value='" + value.Lista47.toFixed(3) +"' />$ " + formatNumber.new(value.Lista47.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista47_iva-" + index + "' value='" + value.Lista47_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista47_iva.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalMbvsstgp_47-" + index + "' value='" + value.Mbvsstgp_47.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_47.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalPMin29-" + index + "' value='" + value.PMin29.toFixed(3) +"' />$ " + formatNumber.new(value.PMin29.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista29-" + index + "' value='" + value.Lista29.toFixed(3) +"' />$ " + formatNumber.new(value.Lista29.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista29_iva-" + index + "' value='" + value.Lista29_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista29_iva.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalMbvsstgp_29-" + index + "' value='" + value.Mbvsstgp_29.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_29.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalPMin28-" + index + "' value='" + value.PMin28.toFixed(3) +"' />$ " + formatNumber.new(value.PMin28.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista28-" + index + "' value='" + value.Lista28.toFixed(3) +"' />$ " + formatNumber.new(value.Lista28.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista28_iva-" + index + "' value='" + value.Lista28_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista28_iva.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalMbvsstgp_28-" + index + "' value='" + value.Mbvsstgp_28.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_28.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalPMin22-" + index + "' value='" + value.PMin22.toFixed(3) +"' />$ " + formatNumber.new(value.PMin22.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista22-" + index + "' value='" + value.Lista22.toFixed(3) +"' />$ " + formatNumber.new(value.Lista22.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalLista22_iva-" + index + "' value='" + value.Lista22_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista22_iva.toFixed(3)) + "</td>\
                                <td class='colore wht'><input type='hidden' id='PrecioOriginalMbvsstgp_22-" + index + "' value='" + value.Mbvsstgp_22.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_22.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalPMin42-" + index + "' value='" + value.PMin42.toFixed(3) +"' />$ " + formatNumber.new(value.PMin42.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista42-" + index + "' value='" + value.Lista42.toFixed(3) +"' />$ " + formatNumber.new(value.Lista42.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista42_iva-" + index + "' value='" + value.Lista42_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista42_iva.toFixed(3)) + "</td>\
                                <td class='colorefp wht'><input type='hidden' id='PrecioOriginalMbvsstgp_42-" + index + "' value='" + value.Mbvsstgp_42.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_42.toFixed(3)) + "</td>\
                        </tr >\
                         <tr class='hidden-price-id-"+ index + "'>\
                            <td>\
                                <input type='text' class='Listax' id='keySelected-"+ index + "' value='" + value.ItemCode + "' disabled/>\
                                <input type='hidden' class='Listax' id='sequenceFamilia-"+ index + "' value='" + value.SequenceFamilia + "' disabled/>\
                                <div class='btn-group'>\
                                  <button type='button' class='btn btn-warning' onclick='return hideTr(" + index + ")'><i class='fa fa-eye-slash'></i></button>\
                                  <button type='button' class='btn btn-success' onclick='return registrarModificacionPrecios(" + index + ")' ><i class='fa fa-thumbs-up'></i></button>\
                                </div>\
                            </td>\
                            <td style='display:none'><input type='text'  id='NombreProducto-" + index + "' value='" + value.NombreProducto + "' disabled/></td>\
                            <td class= 'CmbTipoPrecio' >\
                               <div class='form-group'>\
                                   <select id='selected-tipoprecio-"+ index + "' onchange='getval(this," + index + ");' class='form-control'></select>\
	                            </div>\
                            </td>\
                            <td class='Familiax'>\
                                <input type='text' id='input-familia-"+ index + "' value='" + value.FamSIAT + "' size='4'>\
                                <a id='boton-"+ index + "' class='btn btn-social-icon btn-dropbox  pull-right' data-target='#myModalFamilia' data-toggle='modal' data-id='" + value.ItemCode + "' href='#'>\
                                    <i class='fa fa-plus-square'></i>\
                                </a>\
                            </td>\
                            <td>" + value.PzaMay + "</td>\
                            <td>" + value.PzaMayCorp + "</td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas decimal' id='ListaCMex-" + index + "' onKeyup='OperacionCMex(" + value.STGP10 + "," + index + ")' name='numeric' value='" + value.CMex.toFixed(3)+"' required /></td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas decimal' id='ListaSTGP10-" + index + "' onKeyup='Operacion10(" + value.STGP10 + "," + index + ")' name='numeric' value='" + value.STGP10.toFixed(3)+"' required /></td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista40Update-" + index + "' value='" + value.Lista40.toFixed(3) + "' disabled /> <p id='legend-under-price-mtl-" + index + "'></p></td >\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas decimal' id='Lista40UpdateIva-" + index + "' onKeyup='Operacion40(" + value.CMex + "," + value.Fac40 + "," + index + "," + value.STGP10 + "," + value.Fac39 + "," + value.Fac38 + "," + value.Fac15 + "," + value.Fac3 + "," + value.Fac6 + "," + value.Fac2 + ")' name='numeric' value ='" + value.Lista40_iva.toFixed(3)+"' required /><p id='TextoLista40-" + index + "'></p></td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista40UpdateMargen-" + index + "' disabled /></td>\
                            <td class='td-mf-" + index + "'><input type='text' class='Listas' id='Lista39Update-" + index + "' value='" + value.Lista39.toFixed(3) + "' disabled /><p id='legend-under-price-mf-" + index + "'></p></td>\
                            <td class='td-mt-" + index + "'><input type='text' class='Listas' id='Lista39UpdateIva-" + index + "' value='" + value.Lista39_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                            <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista38Update-" + index + "' value='" + value.Lista38 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                            <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista38UpdateIva-" + index + "' value='" + value.Lista38_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                            <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista15Update-" + index + "' value='" + value.Lista15 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista15UpdateIva-" + index + "' value='" + value.Lista15_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista15UpdateMargen-" + index + "' value='" + value.Mbvsstgp_15.toFixed(3) + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                            <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista6Update-" + index + "' value='" + value.Lista6 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista6UpdateIva-" + index + "' value='" + value.Lista6_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista6UpdateMargen-" + index + "' value='" + value.Mbvsstgp_6.toFixed(3) + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                            <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista3Update-" + index + "' value='" + value.Lista3 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista3UpdateIva-" + index + "' value='" + value.Lista3_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista3UpdateMargen-" + index + "' value='" + value.Mbvsstgp_3.toFixed(3) + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                            <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista2Update-" + index + "' value='" + value.Lista2 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista2UpdateIva-" + index + "' value='" + value.Lista2_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                            <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista2UpdateMargen-" + index + "' value='" + value.Mbvsstgp_2.toFixed(3) + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista33PMin-" + index + "' value='" + value.PMin33 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista33Update-" + index + "' value='" + value.Lista33 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista33UpdateIva-" + index + "' value='" + value.Lista33_iva + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista33UpdateMargen-" + index + "' value='" + value.Mbvsstgp_33.toFixed(3) + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista25PMin-" + index + "' value='" + value.PMin25 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista25Update-" + index + "' value='" + value.Lista25 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista25UpdateIva-" + index + "' value='" + value.Lista25_iva + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista25UpdateMargen-" + index + "' value='" + value.Mbvsstgp_25.toFixed(3) + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-pfr-" + index + "'> <input type='text' class='Listas' id='Lista14PMin-" + index + "' value='" + value.PMin14 + "' disabled /> <p id='legend-under-price-pfr-" + index + "'></p></td >\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista14Update-" + index + "' value='" + value.Lista14 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista14UpdateIva-" + index + "' value='" + value.Lista14_iva + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista14UpdateMargen-" + index + "' value='" + value.Mbvsstgp_14.toFixed(3) + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-pfr-" + index + "'> <input type='text' class='Listas' id='Lista48PMin-" + index + "' value='" + value.PMin48 + "' disabled /> <p id='legend-under-price-pfr-" + index + "'></p></td >\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista48Update-" + index + "' value='" + value.Lista48 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista48UpdateIva-" + index + "' value='" + value.Lista48_iva + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista48UpdateMargen-" + index + "' value='" + value.Mbvsstgp_48.toFixed(3) + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-pfr-" + index + "'> <input type='text' class='Listas' id='Lista47PMin-" + index + "' value='" + value.PMin47 + "' disabled /> <p id='legend-under-price-pfr-" + index + "'></p></td >\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista47Update-" + index + "' value='" + value.Lista47 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista47UpdateIva-" + index + "' value='" + value.Lista47_iva + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista47UpdateMargen-" + index + "' value='" + value.Mbvsstgp_47.toFixed(3) + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista29PMin-" + index + "' value='" + value.PMin29 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista29Update-" + index + "' value='" + value.Lista29 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista29UpdateIva-" + index + "' value='" + value.Lista29_iva + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista29UpdateMargen-" + index + "' value='" + value.Mbvsstgp_29.toFixed(3) + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista28PMin-" + index + "' value='" + value.PMin28 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista28Update-" + index + "' value='" + value.Lista28 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista28UpdateIva-" + index + "' value='" + value.Lista28_iva + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista28UpdateMargen-" + index + "' value='" + value.Mbvsstgp_28.toFixed(3) + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista22PMin-" + index + "' value='" + value.PMin22 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista22Update-" + index + "' value='" + value.Lista22 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista22UpdateIva-" + index + "' value='" + value.Lista22_iva + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista22UpdateMargen-" + index + "' value='" + value.Mbvsstgp_22.toFixed(3) + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista42PMin-" + index + "' value='" + value.PMin42 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista42Update-" + index + "' value='" + value.Lista42 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista42UpdateIva-" + index + "' value='" + value.Lista42_iva + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                            <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista42UpdateMargen-" + index + "' value='" + value.Mbvsstgp_42.toFixed(3) + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                         </tr>");

                    }else if (Rol == 'Administrador') {
                        //Tabla para Rol administrador 
                        //Listas habilitadas: 33, 25, 14, 48, 47, 29, 29, 22, 42
                        $("#detalle-lista-precios").append(
                            "<tr class='Listas' style='background:#cce6ff' id='tr-change-color-" + index + "'>\
                            <td ondblclick='showTr("+ index + ")'>" + value.ItemCode + "</td>\
                            <td>" + value.TipoPrecio + "</td>\
                            <td>" + value.FamSIAT + "</td>\
                            <td>" + value.PzaMay + "</td>\
                            <td>" + value.PzaMayCorp + "</td>\
                            <td class='wht'><input type='hidden' id='PrecioOriginalListaCMex-" + index + "' value='" + value.CMex.toFixed(3) +"' />$ " + formatNumber.new(value.CMex.toFixed(3)) + "</td>\
                            <td class='wht'><input type='hidden' id='PrecioOriginalSTGP10-" + index + "' value='" + value.STGP10.toFixed(3) +"' />$ " + formatNumber.new(value.STGP10.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista40-" + index + "' value='" + value.Lista40.toFixed(3) +"' />$ " + formatNumber.new(value.Lista40.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista40_ivax-" + index + "' value='" + value.Lista40_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista40_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalMbvsstgp_40-" + index + "' value='" + value.Mbvsstgp_40.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_40.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista39-" + index + "' value='" + value.Lista39.toFixed(3) +"' />$ " + formatNumber.new(value.Lista39.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista39_iva-" + index + "' value='" + value.Lista39_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista39_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista38-" + index + "' value='" + value.Lista38.toFixed(3) +"' />$ " + formatNumber.new(value.Lista38.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista38_iva-" + index + "' value='" + value.Lista38_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista38_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista15-" + index + "' value='" + value.Lista15.toFixed(3) +"' />$ " + formatNumber.new(value.Lista15.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista15_iva-" + index + "' value='" + value.Lista15_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista15_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalMbvsstgp_15-" + index + "' value='" + value.Mbvsstgp_15.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_15.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista6-" + index + "' value='" + value.Lista6.toFixed(3) +"' />$ " + formatNumber.new(value.Lista6.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista6_iva-" + index + "' value='" + value.Lista6_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista6_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalMbvsstgp_6-" + index + "' value='" + value.Mbvsstgp_6.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_6.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista3-" + index + "' value='" + value.Lista3.toFixed(3) +"' />$ " + formatNumber.new(value.Lista3.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista3_iva-" + index + "' value='" + value.Lista3_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista3_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalMbvsstgp_3-" + index + "' value='" + value.Mbvsstgp_3.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_3.toFixed(3)) + "</td>\
                            <td class='colore wht wht'><input type='hidden' id='PrecioOriginalLista2-" + index + "' value='" + value.Lista2.toFixed(3) +"' />$ " + formatNumber.new(value.Lista2.toFixed(3)) + "</td>\
                            <td class='colore wht wht'><input type='hidden' id='PrecioOriginalLista2_iva-" + index + "' value='" + value.Lista2_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista2_iva.toFixed(3)) + "</td>\
                            <td class='colore wht wht'><input type='hidden' id='PrecioOriginalMbvsstgp_2-" + index + "' value='" + value.Mbvsstgp_2.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_2.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalPMin33-" + index + "' value='" + value.PMin33.toFixed(3) +"' />$ " + formatNumber.new(value.PMin33.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista33-" + index + "' value='" + value.Lista33.toFixed(3) +"' />$ " + formatNumber.new(value.Lista33.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista33_iva-" + index + "' value='" + value.Lista33_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista33_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalListaMbvsstgp_33-" + index + "' value='" + value.Mbvsstgp_33.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_33.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalListaPMin25-" + index + "' value='" + value.PMin25.toFixed(3) +"' />$ " + formatNumber.new(value.PMin25.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista25-" + index + "' value='" + value.Lista25.toFixed(3) +"' />$ " + formatNumber.new(value.Lista25.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista25_iva-" + index + "' value='" + value.Lista25_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista25_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalListaMbvsstgp_25-" + index + "' value='" + value.Mbvsstgp_25.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_25.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalListaPMin14-" + index + "' value='" + value.PMin14.toFixed(3) +"' />$ " + formatNumber.new(value.PMin14.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista14-" + index + "' value='" + value.Lista14.toFixed(3) +"' />$ " + formatNumber.new(value.Lista14.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista14_iva-" + index + "' value='" + value.Lista14_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista14_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalListaMbvsstgp_14-" + index + "' value='" + value.Mbvsstgp_14.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_14.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalListaPMin48-" + index + "' value='" + value.PMin48.toFixed(3) +"' />$ " + formatNumber.new(value.PMin48.toFixed(3)) + "</td>\
                            <td class='colore wht' ><input type='hidden' id='PrecioOriginalLista48-" + index + "' value='" + value.Lista48.toFixed(3) +"' />$ " + formatNumber.new(value.Lista48.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista48_iva-" + index + "' value='" + value.Lista48_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista48_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalListaMbvsstgp_48-" + index + "' value='" + value.Mbvsstgp_48.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_48.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalListaPMin47-" + index + "' value='" + value.PMin47.toFixed(3) +"' />$ " + formatNumber.new(value.PMin47.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista47-" + index + "' value='" + value.Lista47.toFixed(3) +"' />$ " + formatNumber.new(value.Lista47.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista47_iva-" + index + "' value='" + value.Lista47_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista47_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalListaMbvsstgp_47-" + index + "' value='" + value.Mbvsstgp_47.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_47.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalListaPMin29-" + index + "' value='" + value.PMin29.toFixed(3) +"' />$ " + formatNumber.new(value.PMin29.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista29-" + index + "' value='" + value.Lista29.toFixed(3) +"' />$ " + formatNumber.new(value.Lista29.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista29_iva-" + index + "' value='" + value.Lista29_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista29_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalListaMbvsstgp_29-" + index + "' value='" + value.Mbvsstgp_29.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_29.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalListaPMin28-" + index + "' value='" + value.PMin28.toFixed(3) +"' />$ " + formatNumber.new(value.PMin28.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista28-" + index + "' value='" + value.Lista28.toFixed(3) +"' />$ " + formatNumber.new(value.Lista28.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista28_iva-" + index + "' value='" + value.Lista28_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista28_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalListaMbvsstgp_28-" + index + "' value='" + value.Mbvsstgp_28.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_28.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalListaPMin22-" + index + "' value='" + value.PMin22.toFixed(3) +"' />$ " + formatNumber.new(value.PMin22.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista22-" + index + "' value='" + value.Lista22.toFixed(3) +"' />$ " + formatNumber.new(value.Lista22.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalLista22_iva-" + index + "' value='" + value.Lista22_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista22_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'><input type='hidden' id='PrecioOriginalListaMbvsstgp_22-" + index + "' value='" + value.Mbvsstgp_22.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_22.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalListaPMin42-" + index + "' value='" + value.PMin42.toFixed(3) +"' />$ " + formatNumber.new(value.PMin42.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista42-" + index + "' value='" + value.Lista42.toFixed(3) +"' />$ " + formatNumber.new(value.Lista42.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalLista42_iva-" + index + "' value='" + value.Lista42_iva.toFixed(3) +"' />$ " + formatNumber.new(value.Lista42_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'><input type='hidden' id='PrecioOriginalListaMbvsstgp_42-" + index + "' value='" + value.Mbvsstgp_42.toFixed(3) +"' />% " + formatNumber.new(value.Mbvsstgp_42.toFixed(3)) + "</td>\
                         </tr>\
                         <tr class='hidden-price-id-"+ index + "'>\
                            <td>\
                                <input type='text' class='Listax' id='keySelected-"+ index + "' value='" + value.ItemCode + "' disabled/>\
                                <input type='hidden' class='Listax' id='sequenceFamilia-"+ index + "' value='" + value.SequenceFamilia + "' disabled/>\
                                <input type='hidden' class='Listax' id='esOferta-"+ index + "'  disabled/>\
                                <input type='hidden' class='Listax' id='tipoPrecioAnterior-"+ index + "' value='' disabled/>\
                                <div class='btn-group'>\
                                  <button type='button' class='btn btn-warning' onclick='return hideTr(" + index + ")'><i class='fa fa-eye-slash'></i></button>\
                                  <button type='button' class='btn btn-success' onclick='return registrarModificacionPrecios(" + index + ")' ><i class='fa fa-thumbs-up'></i></button>\
                                </div>\
                            </td>\
                            <td style='display:none'><input type='text'  id='NombreProducto-" + index + "' value='" + value.NombreProducto + "' disabled/></td>\
                            <td class= 'CmbTipoPrecio' >\
                               <div class='form-group'>\
                                   <select id='selected-tipoprecio-"+ index + "' onchange='getval(this," + index + ");' class='form-control'></select>\
	                            </div>\
                            </td>\
                            <td class='Familiax'>\
                               <input type='text' id='input-familia-"+ index + "' value='" + value.FamSIAT + "' size='4'>\
                                <a id='boton-"+ index + "' class='btn btn-social-icon btn-dropbox  pull-right' data-target='#myModalFamilia' data-toggle='modal' data-id='" + value.ItemCode + "' href='#'>\
                                    <i class='fa fa-plus-square'></i>\
                                </a>\
                            </td>\
                        <td>" + value.PzaMay + "</td>\
                        <td>" + value.PzaMayCorp + "</td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='ListaCMex-" + index + "' value='" + value.CMex + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='ListaSTGP10-" + index + "' value='" + value.STGP10 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista40Update-" + index + "' value='" + value.Lista40 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista40UpdateIva-" + index + "' value='" + value.Lista40_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista40UpdateMargen-" + index + "' value='" + value.Mbvsstgp_40 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mf-" + index + "'><input type='text' class='Listas' id='Lista39Update-" + index + "' value='" + value.Lista39 + "' disabled /><p id='legend-under-price-mf-" + index + "'></p></td>\
                        <td class='td-mt-" + index + "'><input type='text' class='Listas' id='Lista39UpdateIva-" + index + "' value='" + value.Lista39_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista38Update-" + index + "' value='" + value.Lista38 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                        <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista38UpdateIva-" + index + "' value='" + value.Lista38_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista15Update-" + index + "' value='" + value.Lista15 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista15UpdateIva-" + index + "' value='" + value.Lista15_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista15UpdateMargen-" + index + "' value='" + value.Mbvsstgp_15 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class= td-psw-" + index + "'><input type='text' class='Listas' id='Lista6Update-" + index + "' value='" + value.Lista6 + "' disabled /> <p id='legend-under-price-psw-" + index + "'></p></td >\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista6UpdateIva-" + index + "' value='" + value.Lista6_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista6UpdateMargen-" + index + "' value='" + value.Mbvsstgp_6 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista3Update-" + index + "' value='" + value.Lista3 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista3UpdateIva-" + index + "' value='" + value.Lista3_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista3UpdateMargen-" + index + "' value='" + value.Mbvsstgp_3 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista2Update-" + index + "' value='" + value.Lista2 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista2UpdateIva-" + index + "' value='" + value.Lista2_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista2UpdateMargen-" + index + "' value='" + value.Mbvsstgp_2 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista33PMin-" + index + "' value='" + value.PMin33 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista33Update-" + index + "' value='" + value.Lista33 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas decimal' id='Lista33UpdateIva-" + index + "' onblur='Cell33OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion33(" + value.STGP10 + "," + index + ")' required  value ='" + value.Lista33_iva.toFixed(3) +"'/></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista33UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista25PMin-" + index + "' value='" + value.PMin25 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista25Update-" + index + "' value='" + value.Lista25 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista25UpdateIva-" + index + "' onblur='Cell25OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion25(" + value.STGP10 + "," + index + ")' required value ='" + value.Lista25_iva.toFixed(3) +"'/></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista25UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista14PMin-" + index + "' value='" + value.PMin14 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista14Update-" + index + "' value='" + value.Lista14 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista14UpdateIva-" + index + "' onblur='Cell14OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion14(" + value.STGP10 + "," + index + ")' required value ='" + value.Lista14_iva.toFixed(3) +"'/></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista14UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista48PMin-" + index + "' value='" + value.PMin48 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista48Update-" + index + "' value='" + value.Lista48 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista48UpdateIva-" + index + "' onblur='Cell48OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion48(" + value.STGP10 + "," + index + ")' required value ='" + value.Lista48_iva.toFixed(3) +"'/></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista48UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista47PMin-" + index + "' value='" + value.PMin47 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista47Update-" + index + "' value='" + value.Lista47 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista47UpdateIva-" + index + "' onblur='Cell47OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion47(" + value.STGP10 + "," + index + ")' required value ='" + value.Lista47_iva.toFixed(3) +"'/></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista47UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista29PMin-" + index + "' value='" + value.PMin29 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista29Update-" + index + "' value='" + value.Lista29 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista29UpdateIva-" + index + "' onblur='Cell29OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion29(" + value.STGP10 + "," + index + ")' required value ='" + value.Lista29_iva.toFixed(3) +"'/></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista29UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista28PMin-" + index + "' value='" + value.PMin28 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista28Update-" + index + "' value='" + value.Lista28 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista28UpdateIva-" + index + "' onblur='Cell28OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion28(" + value.STGP10 + "," + index + ")' required value ='" + value.Lista28_iva.toFixed(3) +"'/></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista28UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista22PMin-" + index + "' value='" + value.PMin22 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista22Update-" + index + "' value='" + value.Lista22 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas decimal' id='Lista22UpdateIva-" + index + "' onblur='Cell22OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion22(" + value.STGP10 + "," + index + ")' required value ='" + value.Lista22_iva.toFixed(3) +"'/></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista22UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista42PMin-" + index + "' value='" + value.PMin42 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista42Update-" + index + "' value='" + value.Lista42 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas decimal' id='Lista42UpdateIva-" + index + "' onblur='Cell42OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion42(" + value.STGP10 + "," + index + ")' required value ='" + value.Lista42_iva.toFixed(3) +"'/></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista42UpdateMargen-" + index + "' disabled /></td>\
                        </tr>");
                    } else if (User == 'rafael.masso@fussionweb.com' || User == 'francisco_martinez@fussionweb.com') {

                        $("#detalle-lista-precios").append(
                            "<tr class='Listas' style='background:#cce6ff' id='tr-change-color-" + index + "'>\
                            <td ondblclick='showTr("+ index + ")'>" + value.ItemCode + "</td>\
                            <td>" + value.TipoPrecio + "</td>\
                            <td>" + value.FamSIAT + "</td>\
                            <td>" + value.PzaMay + "</td>\
                            <td>" + value.PzaMayCorp + "</td>\
                            <td class='wht'>$ " + formatNumber.new(value.CMex.toFixed(3)) + "</td>\
                            <td class='wht'>$ " + formatNumber.new(value.STGP10.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.Lista40.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.Lista40_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'>% " + formatNumber.new(value.Mbvsstgp_40.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.Lista39.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.Lista39_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.Lista38.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.Lista38_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.Lista15.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.Lista15_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>% " + formatNumber.new(value.Mbvsstgp_15.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.Lista6.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.Lista6_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'>% " + formatNumber.new(value.Mbvsstgp_6.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.Lista3.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.Lista3_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>% " + formatNumber.new(value.Mbvsstgp_3.toFixed(3)) + "</td>\
                            <td class='colore wht wht'>$ " + formatNumber.new(value.Lista2.toFixed(3)) + "</td>\
                            <td class='colore wht wht'>$ " + formatNumber.new(value.Lista2_iva.toFixed(3)) + "</td>\
                            <td class='colore wht wht'>% " + formatNumber.new(value.Mbvsstgp_2.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.PMin33.toFixed(3)) + "</td>\
                            <td class='colorefp wht' id='PrecioOriginalLista33-"+ index + "'>$ " + formatNumber.new(value.Lista33.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.Lista33_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>% " + formatNumber.new(value.Mbvsstgp_33.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.PMin25.toFixed(3)) + "</td>\
                            <td class='colore wht'  id='PrecioOriginalLista25-"+ index + "'>$ " + formatNumber.new(value.Lista25.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.Lista25_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'>% " + formatNumber.new(value.Mbvsstgp_25.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.PMin14.toFixed(3)) + "</td>\
                            <td class='colorefp wht'  id='PrecioOriginalLista14-"+ index + "'>$ " + formatNumber.new(value.Lista14.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.Lista14_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>% " + formatNumber.new(value.Mbvsstgp_14.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.PMin48.toFixed(3)) + "</td>\
                            <td class='colore wht'  id='PrecioOriginalLista48-"+ index + "'>$ " + formatNumber.new(value.Lista48.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.Lista48_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'>% " + formatNumber.new(value.Mbvsstgp_48.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.PMin47.toFixed(3)) + "</td>\
                            <td class='colorefp wht'  id='PrecioOriginalLista47-"+ index + "'>$ " + formatNumber.new(value.Lista47.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.Lista47_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>% " + formatNumber.new(value.Mbvsstgp_47.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.PMin29.toFixed(3)) + "</td>\
                            <td class='colore wht'  id='PrecioOriginalLista29-"+ index + "'>$ " + formatNumber.new(value.Lista29.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.Lista29_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'>% " + formatNumber.new(value.Mbvsstgp_29.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.PMin28.toFixed(3)) + "</td>\
                            <td class='colorefp wht'  id='PrecioOriginalLista28-"+ index + "'>$ " + formatNumber.new(value.Lista28.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.Lista28_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>% " + formatNumber.new(value.Mbvsstgp_28.toFixed(3)) + "</td>\
                             <td class='colore wht'>$ " + formatNumber.new(value.PMin22.toFixed(3)) + "</td>\
                            <td class='colore wht' id='PrecioOriginalLista22-"+ index + "'>$ " + formatNumber.new(value.Lista22.toFixed(3)) + "</td>\
                            <td class='colore wht'>$ " + formatNumber.new(value.Lista22_iva.toFixed(3)) + "</td>\
                            <td class='colore wht'>% " + formatNumber.new(value.Mbvsstgp_22.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.PMin42.toFixed(3)) + "</td>\
                            <td class='colorefp wht' id='PrecioOriginalLista42-"+ index + "'>$ " + formatNumber.new(value.Lista42.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>$ " + formatNumber.new(value.Lista42_iva.toFixed(3)) + "</td>\
                            <td class='colorefp wht'>% " + formatNumber.new(value.Mbvsstgp_42.toFixed(3)) + "</td>\
                         </tr>\
                         <tr class='hidden-price-id-"+ index + "'>\
                            <td>\
                                <input type='text' class='Listax' id='keySelected-"+ index + "' value='" + value.ItemCode + "' disabled/>\
                                <input type='hidden' class='Listax' id='sequenceFamilia-"+ index + "' value='" + value.SequenceFamilia + "' disabled/>\
                                <input type='hidden' class='Listax' id='esOferta-"+ index + "'  disabled/>\
                                <input type='hidden' class='Listax' id='tipoPrecioAnterior-"+ index + "' value='' disabled/>\
                                <div class='btn-group'>\
                                  <button type='button' class='btn btn-warning' onclick='return hideTr(" + index + ")'><i class='fa fa-eye-slash'></i></button>\
                                  <button type='button' class='btn btn-success' onclick='return registrarModificacionPrecios(" + index + ")' ><i class='fa fa-thumbs-up'></i></button>\
                                </div>\
                            </td>\
                            <td style='display:none'><input type='text'  id='NombreProducto-" + index + "' value='" + value.NombreProducto + "' disabled/></td>\
                            <td class= 'CmbTipoPrecio' >\
                               <div class='form-group'>\
                                   <select id='selected-tipoprecio-"+ index + "' onchange='getval(this," + index + ");' class='form-control'></select>\
	                            </div>\
                            </td>\
                            <td class='Familiax'>\
                               <input type='text' id='input-familia-"+ index + "' value='" + value.FamSIAT + "' size='4'>\
                                <a id='boton-"+ index + "' class='btn btn-social-icon btn-dropbox  pull-right' data-target='#myModalFamilia' data-toggle='modal' data-id='" + value.ItemCode + "' href='#'>\
                                    <i class='fa fa-plus-square'></i>\
                                </a>\
                            </td>\
                        <td>" + value.PzaMay + "</td>\
                        <td>" + value.PzaMayCorp + "</td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='ListaCMex-" + index + "' value='" + value.CMex + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='ListaSTGP10-" + index + "' value='" + value.STGP10 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista40Update-" + index + "' value='" + value.Lista40 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista40UpdateIva-" + index + "' value='" + value.Lista40_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista40UpdateMargen-" + index + "' value='" + value.Mbvsstgp_40 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mf-" + index + "'><input type='text' class='Listas' id='Lista39Update-" + index + "' value='" + value.Lista39 + "' disabled /><p id='legend-under-price-mf-" + index + "'></p></td>\
                        <td class='td-mt-" + index + "'><input type='text' class='Listas' id='Lista39UpdateIva-" + index + "' value='" + value.Lista39_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista38Update-" + index + "' value='" + value.Lista38 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                        <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista38UpdateIva-" + index + "' value='" + value.Lista38_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista15Update-" + index + "' value='" + value.Lista15 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista15UpdateIva-" + index + "' value='" + value.Lista15_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista15UpdateMargen-" + index + "' value='" + value.Mbvsstgp_15 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class= 'td-psw-" + index + "' > <input type='text' class='Listas' id='Lista6Update-" + index + "' value='" + value.Lista6 + "' disabled /> <p id='legend-under-price-psw-" + index + "'></p></td >\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista6UpdateIva-" + index + "' value='" + value.Lista6_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista6UpdateMargen-" + index + "' value='" + value.Mbvsstgp_6 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista3Update-" + index + "' value='" + value.Lista3 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista3UpdateIva-" + index + "' value='" + value.Lista3_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista3UpdateMargen-" + index + "' value='" + value.Mbvsstgp_3 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-psw-" + index + "'><input type='text' class='Listas' id='Lista2Update-" + index + "' value='" + value.Lista2 + "' disabled /><p id='legend-under-price-psw-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista2UpdateIva-" + index + "' value='" + value.Lista2_iva + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mtl-" + index + "'><input type='text' class='Listas' id='Lista2UpdateMargen-" + index + "' value='" + value.Mbvsstgp_2 + "' disabled /><p id='legend-under-price-mtl-" + index + "'></p></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista33PMin-" + index + "' value='" + value.PMin33 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista33Update-" + index + "' value='" + value.Lista33 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas decimal' id='Lista33UpdateIva-" + index + "' onblur='Cell33OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion33(" + value.STGP10 + "," + index + ")' required /></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista33UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista25PMin-" + index + "' value='" + value.PMin25 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista25Update-" + index + "' value='" + value.Lista25 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista25UpdateIva-" + index + "' onblur='Cell25OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion25(" + value.STGP10 + "," + index + ")' required /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista25UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista14PMin-" + index + "' value='" + value.PMin14 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista14Update-" + index + "' value='" + value.Lista14 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista14UpdateIva-" + index + "' onblur='Cell14OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion14(" + value.STGP10 + "," + index + ")' required /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista14UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista48PMin-" + index + "' value='" + value.PMin48 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista48Update-" + index + "' value='" + value.Lista48 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista48UpdateIva-" + index + "' onblur='Cell48OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion48(" + value.STGP10 + "," + index + ")' required /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista48UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista47PMin-" + index + "' value='" + value.PMin47 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista47Update-" + index + "' value='" + value.Lista47 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista47UpdateIva-" + index + "' onblur='Cell47OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion47(" + value.STGP10 + "," + index + ")' required /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista47UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista29PMin-" + index + "' value='" + value.PMin29 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista29Update-" + index + "' value='" + value.Lista29 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista29UpdateIva-" + index + "' onblur='Cell29OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion29(" + value.STGP10 + "," + index + ")' required /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista29UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista28PMin-" + index + "' value='" + value.PMin28 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista28Update-" + index + "' value='" + value.Lista28 + "' disabled /><p id='legend-under-price-pfr-" + index + "'></p></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas decimal' id='Lista28UpdateIva-" + index + "' onblur='Cell28OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion28(" + value.STGP10 + "," + index + ")' required /></td>\
                        <td class='td-pfr-" + index + "'><input type='text' class='Listas' id='Lista28UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista22PMin-" + index + "' value='" + value.PMin22 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista22Update-" + index + "' value='" + value.Lista22 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas decimal' id='Lista22UpdateIva-" + index + "' onblur='Cell22OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion22(" + value.STGP10 + "," + index + ")' required /></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista22UpdateMargen-" + index + "' disabled /></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista42PMin-" + index + "' value='" + value.PMin42 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista42Update-" + index + "' value='" + value.Lista42 + "' disabled /> <p id='legend-under-price-mfr-" + index + "'></p></td >\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas decimal' id='Lista42UpdateIva-" + index + "' onblur='Cell42OnBlur(" + value.CMex + "," + index + ")' onKeyup='Operacion42(" + value.STGP10 + "," + index + ")' required /></td>\
                        <td class='td-mfr-" + index + "'><input type='text' class='Listas' id='Lista42UpdateMargen-" + index + "' disabled /></td>\
                        </tr>");
                    }
                    $(".hidden-price-id-" + index).hide();
                    changeColorValidaProductoSincronizado(index);
                    //AJAX para combo del tipo de precio
                    $.ajax({
                        contentType: "application/json; charset=utf-8",
                        url: '@Url.Action("GetTipoPrecios", "Precios")',
                        async: false,
                        timeout: 3000,
                        type: 'POST',
                        dataType: "json", 
                        success: function (data) {
                            if (data.Context != null) {
                                let selected = $('#selected-tipoprecio-' + index);
                                //Colocal el identificador de tipo de precio en campo oculto para guardar en caso de realizar una oferta
                                //let tipoPrecio = $('#tipoPrecioAnterior-' + index);
                                $.each(data.Context, function (index1, value1) {
                                    if (value1.Descripcion == value.TipoPrecio) {
                                        //tipoPrecio.val(value1.Identifier)
                                        $('#tipoPrecioAnterior-' + index).val(value1.Identifier);
                                        selected.append(
                                            "<option selected='selected' value='" + value1.Identifier + "'>" + value1.Descripcion + "</option>");
                                    }
                                    else {
                                        selected.append(
                                            "<option class='SelectedTipoPrecio' value='" + value1.Identifier + "'>" + value1.Descripcion + "</option>");
                                    }
                                });
                            }
                        },
                    });


                });
                $('#cargandoPrecios').hide();
            } else {

                $('#cargandoPrecios').hide();
                swal("Error","Error en la api: Funcion buscar falló","error");
            }
         });
    }
    
    /**
    * Funcion  para cerrar el modal de oferta.
    */
    function cerrarModalOferta() {
        //reseteo de  campos
        $('#ofertaSKU').removeAttr('checked')
        $('#ofertaFamilia').removeAttr('checked')           
        $('#fechasOferta').val('')
        $('#tipoPrecioAnterior').val('')
        $('#skuOferta').val('')
        $('#familiaOferta').val('')   
        $('#comentarioOferta').val('')   
        $('#cerrarModal').click()
    }

    /**
    * Funcion  Change  del combo para cambiar tipo de precio.
    */   
    function getval(sel, index) {
        var sequenceFamilia = $("#sequenceFamilia-" + index).val();
        let User = localStorage.getItem("UserEmail");
        let ItemCode = $("#keySelected-" + index).val();
        let Familia = $("#input-familia-" + index).val(); 
        let tipoPrecioAnterior = $("#tipoPrecioAnterior-" + index).val()
        
       //si el tipo de precio es oferta, se despliega el modal de oferta para introducir la informacion complementaria 
        if (sel.value == 4 && User == 'rafael.massorivera@fussionweb.com') {
            //index para obtener valor segun renglon de tabla 
            $('#indexOferta').val(index)
            //valores de SKU y familia en input deshabilitados en modal
            $('#skuOferta').val(ItemCode)
            $('#familiaOferta').val(Familia)            
            $('#tipoPrecioAnteriorOferta').val(tipoPrecioAnterior)            
            
            //inicializa valores para el selector de rango de fecha 
            $('#fechasOferta').daterangepicker({
                autoUpdateInput: false,
                locale: {
                    applyLabel: "Seleccionar",
                    cancelLabel: "Cancelar",
                    daysOfWeek: [
                        "Do",
                        "Lu",
                        "Ma",
                        "Mi",
                        "Ju",
                        "Vi",
                        "Sa"
                    ],
                    monthNames: [
                        "Enero",
                        "Febrero",
                        "Marzo",
                        "Abril",
                        "Mayo",
                        "Junio",
                        "Julio",
                        "Agosto",
                        "Septiembre",
                        "Octubre",
                        "Noviembre",
                        "Diciembre"
                    ]
                }

            });
            //La forma en que despliega los datos en el input cuando da click en aplicar
            $('#fechasOferta').on('apply.daterangepicker', function (ev, picker) {
                $(this).val(picker.startDate.format('MM/DD/YYYY') + ' - ' + picker.endDate.format('MM/DD/YYYY'));
            });

            //Borrar los datos del input cuando se da clic en limpiar
            $('#fechasOferta').on('cancel.daterangepicker', function (ev, picker) {
                $(this).val('');
            });

            $("#modalOferta").modal("show");

        } else if (sel.value == 4 && User != 'rafael.massorivera@fussionweb.com') {
            swal({
                title: 'Atención',
                text: 'No cuentas con permisos para hacer ofertas',
                icon: 'warning'
            })
            myFunctionSearch();
            
        } else {
            let arrayData = '{"TipoPrecioArt":"' + sel.value + '","SequenceFamilia":"' + sequenceFamilia + '"}';
        swal({
            title: "¿Estas seguro?",
            text: "Usted esta a punto de modificar el tipo de Articulo",
            icon: "warning",
            buttons: [
                'No, cancelar esta operación',
                'Si, estoy seguro'
            ],
            dangerMode: true,
        }).then(function (isConfirm) {
            if (isConfirm) {
                $.ajax({
                    contentType: "application/json; charset=utf-8",
                    url: '@Url.Action("UpdateTipoPrecios", "Precios")',
                    async: false,
                    timeout: 3000,
                    type: 'POST',
                    data: arrayData,
                    dataType: "json",
                    success: function (data) {
                        if (data.Context != null) {

                        }
                    },
                });
                myFunctionSearch();
            } else {
                swal({
                    title: 'Cancelado',
                    text: 'Operación cancelada',
                    icon: 'error',
                    buttons: false,
                    timer: 1000

                })
            }
        });

        }
        
    }
     /**
     * Funcion guardarOferta para guardar oferta mediante AJAX.
     */
    function guardarOferta() {

        let index = $('#indexOferta').val()
        let Currency = 'MXP';
        let Ovrwritten = 'Y';
        let comentarioOferta = $("#comentarioOferta").val();        
        let oferta = $('input[name = optionsRadios]:checked').val()
        let Usuario = localStorage.getItem("UserEmail");
        let ItemCode = $("#keySelected-" + index).val();
        let sequenceFamilia = $("#sequenceFamilia-" + index).val();
        let tipoPrecioAnterior = $("#tipoPrecioAnterior-" + index).val();

        let arrayData = '{"TipoPrecioArt":"4","SequenceFamilia":"' + sequenceFamilia + '"}';
        
        
        
        //Validación de campo fechas
        if ($('#fechasOferta').val() == "" ) {
            swal({
                title: 'Atención',
                text: 'Selecciona un rango de fechas',
                icon: 'warning',
                buttons: false,
                timer: 2000

            })
            return 
        } else {

            var fechas = $('#fechasOferta').data('daterangepicker');
            var del = fechas.startDate.format('YYYY/MM/DD');
            var al = fechas.endDate.format('YYYY/MM/DD');
            
        }       
        
        let lista_33 = $("#PrecioOriginalLista33-" + index).val();
        lista_33 = lista_33.replace('$', '')
        lista_33 = lista_33.replace(',', '').trim()
        let lista_25 = $("#PrecioOriginalLista25-" + index).val();
        lista_25 = lista_25.replace('$', '')
        lista_25 = lista_25.replace(',', '').trim()
        let lista_14 = $("#PrecioOriginalLista14-" + index).val();
        lista_14 = lista_14.replace('$', '')
        lista_14 = lista_14.replace(',', '').trim()
        let lista_48 = $("#PrecioOriginalLista48-" + index).val();
        lista_48 = lista_48.replace('$', '')
        lista_48 = lista_48.replace(',', '').trim()
        let lista_47 = $("#PrecioOriginalLista47-" + index).val();
        lista_47 = lista_47.replace('$', '')
        lista_47 = lista_47.replace(',', '').trim()
        let lista_29 = $("#PrecioOriginalLista29-" + index).val();
        lista_29 = lista_29.replace('$', '')
        lista_29 = lista_29.replace(',', '').trim()
        let lista_28 = $("#PrecioOriginalLista28-" + index).val();
        lista_28 = lista_28.replace('$', '')
        lista_28 = lista_28.replace(',', '').trim()
        let lista_22 = $("#PrecioOriginalLista22-" + index).val();
        lista_22 = lista_22.replace('$', '')
        lista_22 = lista_22.replace(',', '').trim()
        let lista_42 = $("#PrecioOriginalLista42-" + index).val();
        lista_42 = lista_42.replace('$', '')
        lista_42 = lista_42.replace(',', '').trim()
        
        let arregloListasPreciosAntesDeOferta = [
            { "PriceList": 33, "Price": lista_33 },
            { "PriceList": 25, "Price": lista_25 },
            { "PriceList": 14, "Price": lista_14 },
            { "PriceList": 48, "Price": lista_48 },
            { "PriceList": 47, "Price": lista_47 },
            { "PriceList": 29, "Price": lista_29 },
            { "PriceList": 28, "Price": lista_28 },
            { "PriceList": 22, "Price": lista_22 },
            { "PriceList": 42, "Price": lista_42 }
        ];
                     

        if (oferta == 'ofertaFamilia') {

            $.ajax({
				contentType: "application/json; charset=utf-8",
				url: '@Url.Action("GuardarOferta", "Ofertas")',
				async: false,
				timeout: 3000,
                type: 'POST',
                data: '{"ItemCode":"' + ItemCode + '","ListasPrecios":' + JSON.stringify(arregloListasPreciosAntesDeOferta) + ',"Currency":"' + Currency + '","Ovrwritten":"' + Ovrwritten + '","RegistradoPor":"' + Usuario + '","OferdaDel":"' + del + '","OferdaAl":"' + al + '","Comentario":"' + comentarioOferta + '","TipoPrecioAnterior":"' + tipoPrecioAnterior + '","AplicaSKU":"0","AplicaFamilia":"1","Estatus":"1","SequenceFamilia":"' + sequenceFamilia + '"}',
				dataType: "json",
				success: function (data) {
					if (data.Context) {
						swal({
							title: 'Correcto',
							text: 'Se ha guardado la oferta.',
							icon: 'success',
							buttons: false,
							timer: 2000
                        })
                        // se actualiza el tipo de precio a toda la familia 
                        $.ajax({
                            contentType: "application/json; charset=utf-8",
                            url: '@Url.Action("UpdateTipoPrecios", "Precios")',
                            async: false,
                            timeout: 3000,
                            type: 'POST',
                            data: arrayData,
                            dataType: "json",
                            success: function (data) {
                                if (data.Context != null) {
                                                                         
                                    cerrarModalOferta();
                                    myFunctionSearch();
                                }
                            },
                            error: function () {
                                swal({
                                    title: 'Error',
                                    text: 'No se ha cambiado el tipo de precio , contacta al administrador de sistemas',
                                    icon: 'error',
                                    buttons: false,
                                    timer: 2000

                                })
                            }
                        });
                        
					} else {
						swal({
							title: 'Error',
							text: 'No se ha guardado la oferta, vuelve a intentarlo',
							icon: 'error',
							buttons: false,
							timer: 2000
						})
					}
				},
				error: function () {
					swal({
						title: 'Error',
                        text: 'No se ha guardado la oferta, vuelve a intentarlo',
						icon: 'error',
						buttons: false,
						timer: 2000

					})
				}
			});        

        } else if (oferta == 'ofertaSKU') {
             $.ajax({
				contentType: "application/json; charset=utf-8",
				url: '@Url.Action("GuardarOferta", "Ofertas")',
				async: false,
				timeout: 3000,
                type: 'POST',
                 data: '{"ItemCode":"' + ItemCode + '","ListasPrecios":' + JSON.stringify(arregloListasPreciosAntesDeOferta)+ ',"Currency":"' + Currency + '","Ovrwritten":"' + Ovrwritten + '","RegistradoPor":"' + Usuario + '","OferdaDel":"' + del + '","OferdaAl":"' + al + '","Comentario":"' + comentarioOferta + '","TipoPrecioAnterior":"' + tipoPrecioAnterior + '","AplicaSKU":"1","AplicaFamilia":"0","Estatus":"1","SequenceFamilia":"' + sequenceFamilia + '"}',
				dataType: "json",
				success: function (data) {
					if (data.Context) {
						swal({
							title: 'Correcto',
							text: 'Se ha guardado la oferta.',
							icon: 'success',
							buttons: false,
							timer: 2000
                        })

                        // se actualiza el tipo de precio al SKU
                         $.ajax({
                            contentType: "application/json; charset=utf-8",
                            url: '@Url.Action("UpdateTipoPreciosOfertaSKu", "Precios")',
                            async: false,
                            timeout: 3000,
                            type: 'POST',
                             data: '{"Sku":"' + ItemCode + '"}',
                            dataType: "json",
                            success: function (data) {
                                if (data.Context != null) {
                                    console.log(data.Context)                                    
                                    cerrarModalOferta();
                                    myFunctionSearch();
                                }
                            },
                            error: function () {
                                swal({
                                    title: 'Error',
                                    text: 'No se ha cambiado el tipo de precio , contacta al administrador de sistemas',
                                    icon: 'error',
                                    buttons: false,
                                    timer: 2000

                                })
                            }
                        });

					} else {
						swal({
							title: 'Error',
							text: 'No se ha guardado la oferta, vuelve a intentarlo',
							icon: 'error',
							buttons: false,
							timer: 2000
						})
					}
				},
				error: function () {
					swal({
						title: 'Error',
                        text: 'No se ha guardado la oferta, vuelve a intentarlo',
						icon: 'error',
						buttons: false,
						timer: 2000

					})
				}
			});  
        } else {
            swal({
                title: 'Atención',
                text: 'Selecciona la forma de guardar la oferta',
                icon: 'warning',
                buttons: false,
                timer: 2000

            })
        }

    }
    
    /**
    * Funcion registrarModificacionPrecios  inserta modificaciones de precios mediante AJAX.
    */
	function registrarModificacionPrecios(index) {
		//validacion vacios o en cero
		var Price_CMex = $("#ListaCMex-" + index).val();
		var Price_10 = $("#ListaSTGP10-" + index).val();
        var Price_40_iva = $("#Lista40UpdateIva-" + index).val();

		if (Price_CMex == "" || Price_CMex == 0 || Price_10 == "" || Price_10 == 0 || Price_40_iva == "" || Price_40_iva == 0){
			swal("Los precios en CMex,STGP y SAP 40 no pueden ir vacios o en 0");
		} else {

			swal({
				title: "¿Estas seguro?",
				text: "Usted esta a punto de proponer una nueva lista de precios",
				icon: "warning",
				buttons: [
					'No, cancelar esta operación',
					'Si, estoy seguro'
				],
				dangerMode: true,
			}).then(function (isConfirm) {
				if (isConfirm) {
				    
					var NombreProducto = $("#NombreProducto-" + index).val();
					var Familia = $("#input-familia-" + index).val();
					var ItemCode = $("#keySelected-" + index).val();
                    var Price_CMex = $("#ListaCMex-" + index).val();                 
                     

					var Price_40 = $("#Lista40Update-" + index).val();
					var Price_39 = $("#Lista39Update-" + index).val();
					var Price_38 = $("#Lista38Update-" + index).val();
					var Price_15 = $("#Lista15Update-" + index).val();
					var Price_3 = $("#Lista3Update-" + index).val();
					var Price_6 = $("#Lista6Update-" + index).val();
					var Price_2 = $("#Lista2Update-" + index).val();

					var Price_33 = $("#Lista33Update-" + index).val();
					var Price_33_Iva = $("#Lista33UpdateIva-" + index).val();
					var Price_25 = $("#Lista25Update-" + index).val();
					var Price_25_Iva = $("#Lista25UpdateIva-" + index).val();
					var Price_14 = $("#Lista14Update-" + index).val();
					var Price_14_Iva = $("#Lista14UpdateIva-" + index).val();
					var Price_48 = $("#Lista48Update-" + index).val();
					var Price_48_Iva = $("#Lista48UpdateIva-" + index).val();
					var Price_47 = $("#Lista47Update-" + index).val();
					var Price_47_Iva = $("#Lista47UpdateIva-" + index).val();
					var Price_29 = $("#Lista29Update-" + index).val();
					var Price_29_Iva = $("#Lista29UpdateIva-" + index).val();
					var Price_28 = $("#Lista28Update-" + index).val();
                    var Price_28_Iva = $("#Lista28UpdateIva-" + index).val();
                    var Price_22 = $("#Lista22Update-" + index).val();
                    var Price_22_Iva = $("#Lista22UpdateIva-" + index).val();
                    var Price_42 = $("#Lista42Update-" + index).val();
                    var Price_42_Iva = $("#Lista42UpdateIva-" + index).val();

                    var PrecioOriginalListaCMex = $("#PrecioOriginalListaCMex-" + index).val();
                    var PrecioOriginalLista40 = $("#PrecioOriginalLista40-" + index).val();
                    var PrecioOriginalSTGP10 = $("#PrecioOriginalSTGP10-" + index).val();
                    
                    var PrecioOriginalLista33_iva = $("#PrecioOriginalLista33-" + index).val();
                    var PrecioOriginalLista25_iva = $("#PrecioOriginalLista25-" + index).val();
                    var PrecioOriginalLista14_iva = $("#PrecioOriginalLista14-" + index).val();
                    var PrecioOriginalLista48_iva = $("#PrecioOriginalLista48-" + index).val();
                    var PrecioOriginalLista47_iva = $("#PrecioOriginalLista47-" + index).val();
                    var PrecioOriginalLista29_iva = $("#PrecioOriginalLista29-" + index).val();
                    var PrecioOriginalLista28_iva = $("#PrecioOriginalLista28-" + index).val();
                    var PrecioOriginalLista22_iva = $("#PrecioOriginalLista22-" + index).val();
                    var PrecioOriginalLista42_iva = $("#PrecioOriginalLista42-" + index).val();

					var Currency = 'MXP';
					var Ovrwritten = 'Y';
					var Estatus = 4;
                   
                    //Validacion de nombre de producto en SIAT
					if (NombreProducto == '') {
						swal('Este sku no esta sincronizado con SIATADMIN');
                    } else {
                        //Validacion de familia en SIAT
						if (Familia == '') {
							swal('Este sku no tiene familia');
                        } else {

                            //let User = localStorage.getItem("UserEmail");                            

                            if (Rol =='Precios') {                             
                                console.log("Entra en precios");
                                if (isNaN(Price_CMex) ||
									isNaN(Price_10) ||
									isNaN(Price_40) ||
									isNaN(Price_39) ||
									isNaN(Price_38) ||
									isNaN(Price_15) ||
									Price_CMex == '0' ||
									Price_10 == '0' ||
									Price_40 == '0' ||
									Price_39 == '0' ||
									Price_38 == '0' ||
									Price_15 == '0' ||
									Price_3 == '0' ||
                                    Price_6 == '0') {                                    
									swal('El sku "' + ItemCode + '" no contiene algún precio importante, favor de verificar.');
								} else {
								    // Se insertan los precios en las listas 39/38/15/3/6 para simulación,
								    let arregloListasRolPrecios = [
										
										{ "Nombre": "39", "Precio": Price_39 ,"ListaModificada":0 },
                                        { "Nombre": "38", "Precio": Price_38, "ListaModificada": 0  },
                                        { "Nombre": "15", "Precio": Price_15, "ListaModificada": 0  },
										{ "Nombre": "3", "Precio": Price_3,"ListaModificada":0  },
                                        { "Nombre": "6", "Precio": Price_6, "ListaModificada": 0  },
                                        { "Nombre": "2", "Precio": Price_2, "ListaModificada": 0   }
                                    ]
                                    
                                    //Se evalua si hubo cambios en las lista  41
                                    if (PrecioOriginalListaCMex == Price_CMex) {
                                       
                                        arregloListasRolPrecios.push(
                                            { "Nombre": "41", "Precio": Price_CMex, "ListaModificada": 0 }
                                        );
                                    } else {
                                        
                                        arregloListasRolPrecios.push(
                                            { "Nombre": "41", "Precio": Price_CMex, "ListaModificada": 1 }
                                        );

                                    }
                                    //Se evalua si hubo cambios en las lista 10
                                    if (PrecioOriginalSTGP10 == Price_10) {
                                        arregloListasRolPrecios.push(
                                            { "Nombre": "10", "Precio": Price_10, "ListaModificada": 0 }
                                        );
                                    } else {
                                        arregloListasRolPrecios.push(
                                            { "Nombre": "10", "Precio": Price_10, "ListaModificada": 1 }
                                        );

                                    }
                                    //Se evalua si hubo cambios en las lista  40
                                    if (PrecioOriginalLista40 == Price_40) {
                                        arregloListasRolPrecios.push(
                                            { "Nombre": "40", "Precio": Price_40, "ListaModificada": 0 }
                                        );
                                    } else {
                                        arregloListasRolPrecios.push(
                                            { "Nombre": "40", "Precio": Price_40, "ListaModificada": 1 }
                                        );

                                    }
                                    //Se insertan las listas de precios con indicador de cual fue modificada para acelerar el proceso de sincronizacion a SAP
									$.ajax({
										contentType: "application/json; charset=utf-8",
										url: '@Url.Action("InsertarListaPropuestaPrecio", "Precios")',
										async: false,
										timeout: 3000,
										type: 'POST',
                                        data: '{"ItemCode":"' + ItemCode + '","ListasPrecios":' + JSON.stringify(arregloListasRolPrecios) + ',"Currency":"' + Currency + '","Ovrwritten":"' + Ovrwritten + '","Estatus":"' + Estatus + '","UsuarioModificador":"' + User + '","Rol":"' + Rol + '"}',
										dataType: "json",
										success: function (data) {

											if (data.Context) {
												swal({
													title: 'Correcto',
													text: 'Se han guardado los cambios.',
													icon: 'success',
													buttons: false,
													timer: 2000
												})
											} else {
												swal({
													title: 'Error',
													text: 'No se han guardado tu cambios, vuelve a intentarlo',
													icon: 'error',
													buttons: false,
													timer: 2000
												})
											}
										},
										error: function () {
											swal({
												title: 'Error',
												text: 'No se han guardado tu cambios, vuelve a intentarlo',
												icon: 'error',
												buttons: false,
												timer: 2000

											})
										}
									});
									//1 Limpio tabla
									clearTableModificados();
									//2 Cargo datos
									onLoadPrecioModificados();
									//3 Cargo lista de email
									//onLoadPreciosModificadosEmail();
									//Oculto tr de busqueda
									hideTr(index);
								}
                            } else if (Rol=='Administrador') {
                                console.log("Entra en admin");
								if (isNaN(Price_33) ||
									isNaN(Price_25) ||
									isNaN(Price_14) ||
									isNaN(Price_48) ||
									isNaN(Price_47) ||
									isNaN(Price_29) ||
									isNaN(Price_28) ||
									isNaN(Price_22) ||
									isNaN(Price_42) ||
									isNaN(Price_33_Iva) ||
									isNaN(Price_25_Iva) ||
									isNaN(Price_14_Iva) ||
									isNaN(Price_48_Iva) ||
									isNaN(Price_47_Iva) ||
									isNaN(Price_29_Iva) ||
									isNaN(Price_28_Iva) ||
									isNaN(Price_22_Iva) ||
									isNaN(Price_42_Iva) ||
									Price_33_Iva == '' ||
									Price_25_Iva == '' ||
									Price_14_Iva == '' ||
									Price_48_Iva == '' ||
									Price_47_Iva == '' ||
									Price_29_Iva == '' ||
									Price_28_Iva == '' ||
									Price_22_Iva == '' ||
									Price_42_Iva == '' ||
									Price_33 == '0' ||
									Price_25 == '0' ||
									Price_14 == '0' ||
									Price_48 == '0' ||
									Price_47 == '0' ||
									Price_29 == '0' ||
									Price_28 == '0' ||
									Price_22 == '0' ||
									Price_42 == '0' ||
									Price_33_Iva == '0' ||
									Price_25_Iva == '0' ||
									Price_14_Iva == '0' ||
									Price_48_Iva == '0' ||
									Price_47_Iva == '0' ||
									Price_29_Iva == '0' ||
									Price_28_Iva == '0' ||
									Price_22_Iva == '0' ||
									Price_42_Iva == '0'
								) {
									swal('El sku "' + ItemCode + '" no contiene algún precio importante, favor de verificar.');
								} else {
									// Se insertan los precios en las listas 33/25/14/48/47/29/28/22/42 para simulación,
                                    let arregloListasRolAdmin = [];
                                    
                                    //Se evalua si hubo cambios en las lista  33
                                    if (PrecioOriginalLista33_iva == Price_33) {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "33", "Precio": Price_33, "ListaModificada": 0 }
                                        );
                                    } else {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "33", "Precio": Price_33, "ListaModificada": 1 }
                                        );

                                    }
                                    //Se evalua si hubo cambios en las lista  25
                                    if (PrecioOriginalLista25_iva == Price_25) {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "25", "Precio": Price_25, "ListaModificada": 0 }
                                        );
                                    } else {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "25", "Precio": Price_25, "ListaModificada": 1 }
                                        );

                                    }
                                    //Se evalua si hubo cambios en las lista  14
                                    if (PrecioOriginalLista14_iva == Price_14) {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "14", "Precio": Price_14, "ListaModificada": 0 }
                                        );
                                    } else {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "14", "Precio": Price_14, "ListaModificada": 1 }
                                        );

                                    }
                                    //Se evalua si hubo cambios en las lista  48
                                    if (PrecioOriginalLista48_iva == Price_48) {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "48", "Precio": Price_48, "ListaModificada": 0 }
                                        );
                                    } else {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "48", "Precio": Price_48, "ListaModificada": 1 }
                                        );

                                    }
                                    //Se evalua si hubo cambios en las lista  47
                                    if (PrecioOriginalLista47_iva == Price_47) {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "47", "Precio": Price_47, "ListaModificada": 0 }
                                        );
                                    } else {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "47", "Precio": Price_47, "ListaModificada": 1 }
                                        );

                                    }
                                    //Se evalua si hubo cambios en las lista  29
                                    if (PrecioOriginalLista29_iva == Price_29) {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "29", "Precio": Price_29, "ListaModificada": 0 }
                                        );
                                    } else {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "29", "Precio": Price_29, "ListaModificada": 1 }
                                        );

                                    }
                                    //Se evalua si hubo cambios en las lista  28
                                    if (PrecioOriginalLista28_iva == Price_28) {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "28", "Precio": Price_28, "ListaModificada": 0 }
                                        );
                                    } else {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "28", "Precio": Price_28, "ListaModificada": 1 }
                                        );

                                    }
                                    //Se evalua si hubo cambios en las lista  22
                                    if (PrecioOriginalLista22_iva == Price_22) {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "22", "Precio": Price_22, "ListaModificada": 0 }
                                        );
                                    } else {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "22", "Precio": Price_22, "ListaModificada": 1 }
                                        );

                                    }
                                    //Se evalua si hubo cambios en las lista  42
                                    if (PrecioOriginalLista42_iva == Price_42) {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "42", "Precio": Price_42, "ListaModificada": 0 }
                                        );
                                    } else {
                                        arregloListasRolAdmin.push(
                                            { "Nombre": "42", "Precio": Price_42, "ListaModificada": 1 }
                                        );

                                    }
                                
									$.ajax({
										contentType: "application/json; charset=utf-8",
										url: '@Url.Action("InsertarListaPropuestaPrecio", "Precios")',
										async: false,
										timeout: 3000,
                                        type: 'POST',
                                        data: '{"ItemCode":"' + ItemCode + '","ListasPrecios":' + JSON.stringify(arregloListasRolAdmin) + ',"Currency":"' + Currency + '","Ovrwritten":"' + Ovrwritten + '","Estatus":"' + Estatus + '","UsuarioModificador":"' + User + '","Rol":"' + Rol + '"}',
										dataType: "json",
										success: function (data) {

											if (data.Context) {
												swal({
													title: 'Correcto',
													text: 'Se han guardado los cambios.',
													icon: 'success',
													buttons: false,
													timer: 2000

												})
											} else {
												swal({
													title: 'Error',
													text: 'No se han guardado tu cambios, vuelve a intentarlo',
													icon: 'error',
													buttons: false,
													timer: 2000

												})
											}


										},
										error: function () {
											swal({
												title: 'Error',
												text: 'No se han guardado tu cambios, vuelve a intentarlo',
												icon: 'error',
												buttons: false,
												timer: 2000

											})
										}
									});

									//1 Limpio tabla
									clearTableModificados();
									//2 Cargo datos
									onLoadPrecioModificados();
									//3 Cargo lista de email
									//onLoadPreciosModificadosEmail();
									//Oculto tr de busqueda
									hideTr(index);
								}
							}
						}
					}

				} else {
					swal({
						title: 'Cancelado',
						text: 'Operación cancelada',
						icon: 'error',
						buttons: false,
						timer: 1000
					})
				}

			});
		}
	}
    //INSERTAR FAMILIA OK
    document.querySelector('#insertar-familia').addEventListener('click', function (e) {
        e.preventDefault();
        swal({
            title: "¿Estas seguro?",
            text: "Usted esta a punto de crear una nueva familia",
            icon: "warning",
            buttons: [
              'No, cancelar esta operación',
              'Si, estoy seguro'
            ],
            dangerMode: true,
        }).then(function (isConfirm) {
            if (isConfirm) {
               
                let Nombre = $("#input-familia").val();
                let MayoreoDesde = $("#input-mayoreo").val();
                let MayoreoDistribuidorDesde = $("#input-mayoreo-crpo").val();
                if (Nombre == '' ||
                    MayoreoDesde == '' ||
                    MayoreoDistribuidorDesde == '' ||
                    Nombre == '0' ||
                    MayoreoDesde == '0' ||
                    MayoreoDistribuidorDesde == '0' ||
                    Nombre == null ||
                    MayoreoDesde == null ||
                    MayoreoDistribuidorDesde == null
                ) {
                    swal('Faltan campos por registrar, no se aceptan valores 0');
                } else {
                    $.post('@Url.Action("InsertarFamilia", "Precios")', {
                        Nombre,
                        MayoreoDesde,
                        MayoreoDistribuidorDesde
                    }, function (data) {
                        });


                    $('#myModal2').modal('hide');

                }
                
            } else {
                swal({
                    title: 'Cancelado',
                    text: 'Operación cancelada',
                    icon: 'error',
                    buttons: false,
                    timer: 1000

                })
            }
        });
    });
    //Cargar COMBO Tipo Precio Art

    //BUSQUEDA MANUAL FAMILIA
    $("#boton-familia-manual").click(function () {

        let selected_family = $("#select-familia-manual");
        selected_family.empty();
        var Nombre = $('#get-familia-manual').val();

        $.post('@Url.Action("ListaFamiliaBusqueda", "Precios")', {
            Nombre
        }, function (data) {
            if (data != null && $.isArray(data.Context)) {

                let selected_family = $("#select-familia-manual");

                $.each(data.Context, function (index, value) {
                    selected_family.append(
                        "<option value=" + value.Sequence + ">Sku: " + value.Nombre + " | Mayoreo: " + value.MayoreoDesde + " " + " | Distribuidor: " + value.MayoreoDistribuidorDesde + "</option>")
                });

            } else {
                swal("Error en la api: Obtener Familias");
            }
        });

    });
    //ASOCIAR FAMILIA OK
    document.querySelector('#asociar-familia').addEventListener('click', function (e) {
        e.preventDefault();
        swal({
            title: "¿Estas seguro?",
            text: "Usted esta a punto de asociar una familia",
            icon: "warning",
            buttons: [
              'No, cancelar esta operación',
              'Si, estoy seguro'
            ],
            dangerMode: true,
        }).then(function (isConfirm) {
            if (isConfirm) {
                
                $('#myModalFamilia').modal('hide');

                let UsuarioModificador = localStorage.getItem("UserEmail");
                let FamiliaTexto = $("#select-familia-manual option:selected").text();
                let Codigo = $('#select-familia-manual').val();
                let Sku = $('#Sku').val();
                //*************************************correos Productivo**************************************************//
                //********************************************************************************************************//
                //let arregloCorreos = new Array("angel_garcia@fussionweb.com", "rafael.massorivera@fussionweb.com");

                //**************************************correos Purebas***************************************************//
                //********************************************************************************************************//
                let arregloCorreos = new Array("armando_pena@fussionweb.com");

                let SubjectEmail = "Asignación de familia";
                let BodyEmail = "<html><body><h4>Asignación de familia al sku "+Sku+"</h4><br/><div>"+FamiliaTexto+"</div><br /></body></html>";
                let FromEmail = UsuarioModificador;

                $.ajax({
                    contentType: "application/json; charset=utf-8",
                    url: '@Url.Action("UpdateFamilyInProduct", "Precios")',
                    async: false,
                    timeout: 3000,
                    type: 'POST',
                    data: '{"Codigo":"' + Codigo + '","Sku":"' + Sku + '"}',
                    dataType: "json",
                    success: function (data) {

                        $.ajax({
                            contentType: "application/json; charset=utf-8",
                            url: '@Url.Action("EmailListPrice", "Precios")',
                            async: false,
                            timeout: 3000,
                            type: 'POST',
                            data: '{"FromEmail":"' + FromEmail + '","SubjectEmail":"' + SubjectEmail + '","BodyEmail":"' + BodyEmail + '","listaCorreos":' + JSON.stringify(arregloCorreos) + '}',
                            dataType: "json",
                            success: function (data) {
                                swal({
                                    title: 'Operación correcta',
                                    text: 'Se ha enviado un correo con sus modificaciones',
                                    icon: 'success',
                                    buttons: false,
                                    timer: 2000
                                })

                            },
                            error: function () {
                                swal("Error en la api: Envio de correo asociar familia");
                            }
                        });
                    },
                    error: function () {
                        swal("Error en la api: Actualizar familia");
                    }
                });
                    
                document.getElementById('click-buscar').click();
                clearTableModificados();
                onLoadPrecioModificados();
               
            } else {
                swal({
                    title: 'Cancelado',
                    text: 'Operación cancelada',
                    icon: 'error',
                    buttons: false,
                    timer: 1000

                })
            }
        });
    });

    /**
    * Funcion onLoadPrecioModificados obtiene todos los estados de precios actuales
    */
    function onLoadPrecioModificados() {

        $('#cargandoModificados').show();
        
        $.post('@Url.Action("ObtenerTodosPreciosEstadosAll", "Precios")', {
        }, function (data) {
            if (data != null && $.isArray(data.Context)) {
                $.each(data.Context, function (index, value) {
                    if (value.Comentario == '') {
                        value.Comentario = 'Sin comentario'
                    }
                    var t = $('#precios-modificados-all').DataTable();
                    t.row.add([
                        '<td id="Modificado">' + value.Estatus + '</td>',
                        '<td class="nr">' + value.ItemCode + '</td>',
                        '<td>' + value.Comentario + '</td>',
                        '<td><div id="td-ar-familiac-' + index + '" ><input type="text" id="nombre-familiac-' + index + '" class="nombre-familia-class" value="' + value.Familia + '" disabled>\<input type="text" id="estatus-familiac-' + index + '" style="display:none" value="' + value.EstatusFamilia + '"></div></td>',
                        '<td>' + value.MayoreoDesde + '</td>',
                        '<td>' + value.MayoreoDistribuidorDesde + '</td>',
                        '<td>' + formatNumber.new(value.ListaCMex_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.ListaCMex.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista10_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista10.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista40_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista40.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista39_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista39.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista38_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista38.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista15_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista15.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista6_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista6.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista3_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista3.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista2_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista2.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista33_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista33.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista25_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista25.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista14_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista14.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista48_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista48.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista47_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista47.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista29_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista29.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista28_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista28.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista22_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista22.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista42_Sap.toFixed(2), "$ ") + '</td>',
                        '<td>' + formatNumber.new(value.Lista42.toFixed(2), "$ ") + '</td>',
                        '<td>' + value.FechaModificacion + '</td>'
                    ]).draw(false);

                });
                $('#cargandoModificados').hide();
            } else {
                swal("Error en la api: Cargar precios modificados");
            }
        });
    }
   
    /**
    * Evento listener del boton "mandar solicitud"
    * Envia correo de los precios modificados segun el rol del usuario modificador
    */
    document.querySelector('#mandar-solicitud').addEventListener('click', function (e) {
        e.preventDefault();
        swal({
            title: "¿Estas seguro?",
            text: "Usted esta a punto de mandar para aprobación",
            icon: "warning",
            buttons: [
              'No, cancelar esta operación',
              'Si, estoy seguro'
            ],
            dangerMode: true,
        }).then(function (isConfirm) {
            if (isConfirm) {
                
                $.ajax({
                    contentType: "application/json; charset=utf-8",
                    url: '@Url.Action("EnvioAprobacionPropuestas", "Precios")',
                    async: false,
                    timeout: 6000,
                    type: 'POST',
                    data: {},
                    dataType: "json",
                    success: function (data) {
                        if (data.Code == 1) {
                            swal({
                                title: 'Operación correcta',
                                text: 'Se ha enviado un correo con sus modificaciones',
                                icon: 'success',
                                buttons: false,
                                timer: 2000
                            })


                        } else if (data.Code == -5) {
                            swal({
                                title: 'Atención',
                                text: 'No hay precios modificados para enviar',
                                icon: 'warning',
                                buttons: false,
                                timer: 2000
                            })

                        } else if (data.Code == -1) {
                            swal({
                                title: 'Error',
                                text: 'Error al enviar correos',
                                icon: 'Error',
                                buttons: false,
                                timer: 2000
                            })
                        } 
                        //1.Limpio Tabla modificados
                        clearTableModificados();
                        //2.Carga Tabla modificados
                        onLoadPrecioModificados();
                    },
                    error: function () {
                        swal("Error en la api: Envio Aprobacion Propuestas");
                    }
                });                
                
            } else {
                swal({
                    title: 'Cancelado',
                    text: 'Operación cancelada',
                    icon: 'error',
                    buttons: false,
                    timer: 1000

                })
            }
        });
    });
    
    
    /**
    * Funcion onLoadPreciosModificadosEmail carga listas de modificados para el correo
    */
    @*function onLoadPreciosModificadosEmail() {
        let User = localStorage.getItem("UserEmail");
        $.post('@Url.Action("ObtenerEstatusFourAll", "Precios")', {
        }, function (data) {
            
            //se limpia el div con las tablas para los correos
            $("#bodyCorreoUno").empty();
            $("#bodyCorreoDos").empty();
            if (data != null && $.isArray(data.Context)) {
                $.each(data.Context, function (index, value) {
                    let listx_40 = formatNumber.new(value.Lista40.toFixed(2), "$ ");
                    let listx_39 = formatNumber.new(value.Lista39.toFixed(2), "$ ");
                    let listx_38 = formatNumber.new(value.Lista38.toFixed(2), "$ ");
                    let listx_33 = formatNumber.new(value.Lista33.toFixed(2), "$ ");
                    let listx_22 = formatNumber.new(value.Lista22.toFixed(2), "$ ");
                    let listx_42 = formatNumber.new(value.Lista42.toFixed(2), "$ ");
                    let listx_25 = formatNumber.new(value.Lista25.toFixed(2), "$ ");
                    let listx_14 = formatNumber.new(value.Lista14.toFixed(2), "$ ");
                    let listx_48 = formatNumber.new(value.Lista48.toFixed(2), "$ ");
                    let listx_47 = formatNumber.new(value.Lista47.toFixed(2), "$ ");
                    let listx_29 = formatNumber.new(value.Lista29.toFixed(2), "$ ");
                    let listx_28 = formatNumber.new(value.Lista28.toFixed(2), "$ ");
                    let listx_10 = formatNumber.new(value.Lista10.toFixed(2), "$ ");

                    //construcción de tabla para envio de correo
                    if (value.Lista40 != 0) {
                        $("#bodyCorreoUno").append(
                            "<tr style ='text-align: center; border: 1px solid black'>\
                            <td style ='border: 1px solid black'>" + value.ItemCode + "</td>\
                            <td style ='border: 1px solid black'>" + value.TipoPrecio + "</td>\
                            <td style ='border: 1px solid black'>" + listx_40 + "</td>\
                            <td style ='border: 1px solid black'>" + listx_10 + "</td>\
                        </tr > ");
                        arregloIdModificadosCorreoUno.push(value.IdModificacion);
                    }
                    
                    //construcción de tabla para envio de correo
                    if (value.Lista33 != 0) {
                        $("#bodyCorreoDos").append(
                            "<tr style ='text-align: center; border: 1px solid black'>\
                            <td style ='border: 1px solid black'>" + value.ItemCode + "</td>\
                            <td style ='border: 1px solid black'>" + value.TipoPrecio + "</td>\
                            <td style ='border: 1px solid black'>" + listx_33 + "</td>\
                            <td style ='border: 1px solid black'>" + listx_25 + "</td>\
                            <td style ='border: 1px solid black'>" + listx_14 + "</td>\
                            <td style ='border: 1px solid black'>" + listx_48 + "</td>\
                            <td style ='border: 1px solid black'>" + listx_47 + "</td>\
                            <td style ='border: 1px solid black'>" + listx_29 + "</td>\
                            <td style ='border: 1px solid black'>" + listx_28 + "</td>\
                            <td style ='border: 1px solid black'>" + listx_22 + "</td>\
                            <td style ='border: 1px solid black'>" + listx_42 + "</td>\
                            </tr > ");
                    } arregloIdModificadosCorreoDos.push(value.IdModificacion);
                });
            } else {
                swal("Error en la api: Error cargar correo con modificaciones");
            }
        });
    }*@
   

   
    /**
    * Funcion sendEmailListModificados envia correo de los precios modificados
    */
    @*function sendEmailListModificados() {
        let arregloCorreosUno
        let arregloCorreosDos
        let UsuarioModificador = localStorage.getItem("UserEmail");
        let RolUsuario = localStorage.getItem("Rol");
        let FromEmail = UsuarioModificador;
        let SubjectEmail = "Aprobación de lista de precios";

        //Se recuperan las tablas creadas y que remplazan las " por ' para el envio con ajax
        if ($('#bodyCorreoUno').html() && (UsuarioModificador == 'rafael_masso@fussionweb.com' || UsuarioModificador == 'angel_garcia@fussionweb.com' || UsuarioModificador == 'armando_pena@fussionweb.com')) {
            

             //*************************************correos Productivo**************************************************//
            //********************************************************************************************************//
           //arregloCorreosUno = new Array("angel_garcia@fussionweb.com","karen_gomez@fussionweb.com","rafael.massorivera@fussionweb.com");

            //**************************************correos Purebas***************************************************//
           //********************************************************************************************************//
           arregloCorreosUno = new Array("armando_pena@fussionweb.com");

            let htmlUno = $('#correoUno').html();
            htmlUno = htmlUno.replace(/['"]+/g, "'");
            
            let BodyEmailUno = "<html>" +
                "<body> "+
                "</br><h3 style='font-family: arial, sans-serif;'>Se han solicitado cambios de precios en los siguientes SKU:</h3></br>"+
                "<div> " +
                htmlUno +
                "</div>" +
                "</br><h4 style='font-family: arial, sans-serif;'>Ingresa al <a style='font-family: arial, sans-serif;' href='https://apps.fussionweb.com/SIE/Account/Login'>SIE</a> para continuar el proceso de autorización</h4>" +
                "</body >" +
            "</html > ";


            $.ajax({
                contentType: "application/json; charset=utf-8",
                url: '@Url.Action("EmailListPrice", "Precios")',
                async: false,
                timeout: 3000,
                type: 'POST',
                data: '{"FromEmail":"' + FromEmail + '","SubjectEmail":"' + SubjectEmail + '","BodyEmail":"' + BodyEmailUno + '","listaCorreos":' + JSON.stringify(arregloCorreosUno) + '}',
                dataType: "json",
                success: function (data) {
                    
                    swal({
                        title: 'Operación correcta',
                        text: 'Se ha enviado un correo con sus modificaciones',
                        icon: 'success',
                        buttons: false,
                        timer: 2000
                    })

                },
                error: function () {
                    swal("Error en la api: No se ha enviado el correo");

                }
            });

        }
        if ($('#bodyCorreoDos').html() && UsuarioModificador =='rafael.massorivera@fussionweb.com') {

            //*************************************correos Productivo**************************************************//
            //********************************************************************************************************//
            //arregloCorreosDos = new Array("rafael.massorivera@fussionweb.com");

            //**************************************correos Purebas***************************************************//
           //********************************************************************************************************//
           arregloCorreosDos = new Array("armando_pena@fussionweb.com");

            let htmlDos = $('#correoDos').html();
            htmlDos = htmlDos.replace(/['"]+/g, "'");
            
            let BodyEmailDos = "<html>" +
                "<body> " +
                "</br><h3 style='font-family: arial, sans-serif;'>Se han solicitado cambios de precios en los siguientes SKU:</h3></br>" +
                "<div> " +
                htmlDos +
                "</div>" +
                "</br><h4 style='font-family: arial, sans-serif;'>Ingresa al <a style='font-family: arial, sans-serif;' href='https://apps.fussionweb.com/SIE/Account/Login'>SIE</a> para continuar el proceso de autorización</h4>" +
                "</body >" +
                "</html > ";
              $.ajax({
                contentType: "application/json; charset=utf-8",
                url: '@Url.Action("EmailListPrice", "Precios")',
                async: false,
                timeout: 5000,
                type: 'POST',
                data: '{"FromEmail":"' + FromEmail + '","SubjectEmail":"' + SubjectEmail + '","BodyEmail":"' + BodyEmailDos + '","listaCorreos":' + JSON.stringify(arregloCorreosDos) + '}',
                dataType: "json",
                success: function (data) {
                    
                    swal({
                        title: 'Operación correcta',
                        text: 'Se ha enviado un correo con sus modificaciones',
                        icon: 'success',
                        buttons: false,
                        timer: 2000
                    })
                },
                error: function () {
                    swal("Error en la api: No se ha enviado el correo");

                }
            });

        }
     
    }*@
</script>
@*Script de Operaciones y Formato de elementos visuales*@
<script>

    $("#get-familia-manual").keypress(function (e) {
        if (e.keyCode == 13) {
            let selected_family = $("#select-familia-manual");
            selected_family.empty();
            var Nombre = $('#get-familia-manual').val();
            $.post('@Url.Action("ListaFamiliaBusqueda", "Precios")', {
                Nombre
                }, function (data) {
                if (data != null && $.isArray(data.Context)) {
                    let selected_family = $("#select-familia-manual");
                    $.each(data.Context, function (index, value) {
                        selected_family.append(
                            "<option value=" + value.Sequence + ">Sku: " + value.Nombre + " | Mayoreo: " + value.MayoreoDesde + " " + " | Distribuidor: " + value.MayoreoDistribuidorDesde + "</option>")
                    });
                } else {
                    swal("Error en la api:No se encuentra la familia");
                }
                });
        }
    });

    //Function enter lista de precios search ----------TECLA ENTER
    $("#ItemCode").keypress(function (e) {
        if (e.keyCode == 13) {
            myFunctionSearch();
        }
    });
    //Funcion para evento click y buscar skus----------BOTON BUSCAR
    $("#click-buscar").on("click", function (e) {
        e.preventDefault();
        myFunctionSearch();
    });
    //Function enter lista de precios search
    $("#txt-search-reference").keypress(function (e) {
        if (e.keyCode == 13) {
            myFunctionSearchReference();
        }
    });
    //Funcion para evento click y buscar skus
    $("#btn-search-reference").on("click", function (e) {
        e.preventDefault();
        myFunctionSearchReference();
    });

    /*********************************************/
    function OperacionCMex(STGP10, index) {

        let get_ListaCMex = parseFloat(document.getElementById("ListaCMex-" + index).value);

        let get_Lista40Update = parseFloat(document.getElementById("Lista40Update-" + index).value);
        let set_Lista40UpdateMargen = (get_Lista40Update - get_ListaCMex) / get_Lista40Update;
        set_Lista40UpdateMargen = (set_Lista40UpdateMargen * 100).toFixed(3);
        $('#Lista40UpdateMargen-' + index).val('%'+set_Lista40UpdateMargen);

        let get_Lista15Update = parseFloat(document.getElementById("Lista15Update-" + index).value);
        let set_Lista15UpdateMargen = (get_Lista15Update - get_ListaCMex) / get_Lista15Update;
        set_Lista15UpdateMargen = (set_Lista15UpdateMargen * 100).toFixed(3);
        $('#Lista15UpdateMargen-' + index).val('%' + set_Lista15UpdateMargen);

        let get_Lista3Update = parseFloat(document.getElementById("Lista3Update-" + index).value);
        let set_Lista3UpdateMargen = (get_Lista3Update - get_ListaCMex) / get_Lista3Update;
        set_Lista3UpdateMargen = (set_Lista3UpdateMargen * 100).toFixed(3);
        $('#Lista3UpdateMargen-' + index).val('%' + set_Lista3UpdateMargen);

        let get_Lista6Update = parseFloat(document.getElementById("Lista6Update-" + index).value);
        let set_Lista6UpdateMargen = (get_Lista6Update - get_ListaCMex) / get_Lista6Update;
        set_Lista6UpdateMargen = (set_Lista6UpdateMargen * 100).toFixed(3);
        $('#Lista6UpdateMargen-' + index).val('%' + set_Lista6UpdateMargen);

        let get_Lista2Update = parseFloat(document.getElementById("Lista2Update-" + index).value);
        let set_Lista2UpdateMargen = (get_Lista2Update - get_ListaCMex) / get_Lista2Update;
        set_Lista2UpdateMargen = (set_Lista2UpdateMargen * 100).toFixed(3);
        $('#Lista2UpdateMargen-' + index).val('%' + set_Lista2UpdateMargen);
        
    }
    /*********************************************/
    function Operacion10(STGP10, index) {
        let get_ListaSTGP10 = parseFloat(document.getElementById("ListaSTGP10-" + index).value);
        Operacion33(get_ListaSTGP10, index)
        Operacion25(get_ListaSTGP10, index)
        Operacion14(get_ListaSTGP10, index)
        Operacion48(get_ListaSTGP10, index)
        Operacion47(get_ListaSTGP10, index)
        Operacion29(get_ListaSTGP10, index)
        Operacion28(get_ListaSTGP10, index)
        Operacion22(get_ListaSTGP10, index)
        Operacion42(get_ListaSTGP10, index)
    }
    /*********************************************/
    function Operacion40(CMex, Fac40, index, STGP10,Fac39,Fac38,Fac15,Fac3,Fac6,Fac2) {
        let get_Lista40UpdateIva = parseFloat(document.getElementById("Lista40UpdateIva-" + index).value);
        let set_listafac40 = get_Lista40UpdateIva * Fac40;
        $("#TextoLista40-" + index).empty();
        //$("#TextoLista40-" + index).append(formatNumber.new("P.Fac: " + set_listafac40.toFixed(3)));
        let set_lista40 = set_listafac40 / 1.16;
        $('#Lista40Update-' + index).val(set_lista40.toFixed(3));

        let get_Lista40Update = parseFloat(document.getElementById("Lista40Update-" + index).value);
        let get_ListaCMex = parseFloat(document.getElementById("ListaCMex-" + index).value);

        let set_Margen40 = 0;
        if (isNaN(get_ListaCMex)) {
            set_Margen40 = (get_Lista40Update - CMex) / set_listafac40;
        }
        else {
            set_Margen40 = (get_Lista40Update - get_ListaCMex) / set_listafac40;
        }
        $("#Lista40UpdateMargen-" + index).append(formatNumber.new(set_Margen40.toFixed(3)));

        OperacionCMex(STGP10, index);
        Operacion39(STGP10, Fac39, index, get_Lista40UpdateIva);
        Operacion38(STGP10, Fac38, index, get_Lista40UpdateIva);
        Operacion15(STGP10, Fac15, index, get_Lista40UpdateIva);
        Operacion3(STGP10, Fac3, index, get_Lista40UpdateIva);
        Operacion6(STGP10, Fac6, index, get_Lista40UpdateIva);
        Operacion2(STGP10, Fac2, index, get_Lista40UpdateIva);
    }
    /*********************************************/
    function Operacion39(STGP10, Fac39, index, base) {
        //calculo de C/iva
        let set_lista39UpdateIva = base * Fac39;
        $('#Lista39UpdateIva-' + index).val(set_lista39UpdateIva);
        //calculo S/iva
        let set_lista39 = set_lista39UpdateIva / 1.16;
        $('#Lista39Update-' + index).val(set_lista39.toFixed(3));
    }
    /*********************************************/
    function Operacion38(STGP10, Fac38, index,base) {
        //calculo de C/iva
        let set_lista38UpdateIva = base * Fac38;
        $('#Lista38UpdateIva-' + index).val(set_lista38UpdateIva);
        //calculo S/iva
        let set_lista38 = set_lista38UpdateIva / 1.16;
        $('#Lista38Update-' + index).val(set_lista38.toFixed(3));

    }
    /*********************************************/
    function Operacion15(STGP10, Fac15, index, base) {
        //calculo de C/iva
        let set_lista15UpdateIva = base * Fac15;
        //let set_lista15UpdateIva = base * 1.16;
        $('#Lista15UpdateIva-' + index).val(set_lista15UpdateIva);
        //calculo S/iva
        let set_lista15 = set_lista15UpdateIva / 1.16;
        $('#Lista15Update-' + index).val(set_lista15.toFixed(3));

    }
    /*********************************************/
    function Operacion3(STGP10, Fac3, index, base) {
        //calculo de C/iva
        let set_lista3UpdateIva = base * Fac3;
        //let set_lista15UpdateIva = base * 1.16;
        $('#Lista3UpdateIva-' + index).val(set_lista3UpdateIva);
        //calculo S/iva
        let set_lista3 = set_lista3UpdateIva / 1.16;
        $('#Lista3Update-' + index).val(set_lista3.toFixed(3));        
    }
    /*********************************************/
    function Operacion6(STGP10, Fac6, index, base) {
        //calculo de C/iva
        let set_lista6UpdateIva = base * Fac6;
        //let set_lista15UpdateIva = base * 1.16;
        $('#Lista6UpdateIva-' + index).val(set_lista6UpdateIva);
        //calculo S/iva
        let set_lista6 = set_lista6UpdateIva / 1.16;
        $('#Lista6Update-' + index).val(set_lista6.toFixed(3));
       
    }
    /*********************************************/
    function Operacion2(STGP10, Fac2, index, base) {
        //calculo de C/iva
        let set_lista2UpdateIva = base * Fac2;
        //let set_lista15UpdateIva = base * 1.16;
        $('#Lista2UpdateIva-' + index).val(set_lista2UpdateIva);
        //calculo S/iva
        let set_lista2 = set_lista2UpdateIva / 1.16;
        $('#Lista2Update-' + index).val(set_lista2.toFixed(3));

    }
    /*********************************************/
    function Operacion33(STGP10, index) {
        
        let get_Lista33UpdateIva = parseFloat(document.getElementById("Lista33UpdateIva-" + index).value);
        let set_lista33 = (get_Lista33UpdateIva / 1.16).toFixed(3);
        $('#Lista33Update-' + index).val(set_lista33);
        let vs_resta33 = set_lista33 - STGP10;
        
        let vs_division33 = vs_resta33 / set_lista33;
        let vs_porcentaje33 = (vs_division33 * 100).toFixed(3);
        
        $('#Lista33UpdateMargen-' + index).val('%'+vs_porcentaje33);
    }
    /*********************************************/

    function Cell33OnBlur(CMex, index) {
        
        let get_Lista33UpdateIva = parseFloat(document.getElementById("Lista33UpdateIva-" + index).value);
        //let set_lista33 = get_Lista33UpdateIva / 1.16;             
        
        if (get_Lista33UpdateIva < CMex)
        {
            swal("Atención","El Precio NO puede ser menor del cMex ","error");
        }
    }
    /*********************************************/
    function Operacion25(STGP10, index) {
        let get_Lista25UpdateIva = parseFloat(document.getElementById("Lista25UpdateIva-" + index).value);
        let set_lista25 = get_Lista25UpdateIva / 1.16;
        $('#Lista25Update-' + index).val(set_lista25);
        let vs_resta = set_lista25 - STGP10;
        let vs_division = vs_resta / set_lista25;
        let vs_porcentaje = (vs_division * 100).toFixed(3);
        $('#Lista25UpdateMargen-' + index).val('%'+vs_porcentaje);
    }
    /*********************************************/
    function Cell25OnBlur(CMex, index) {
        
        let get_Lista25UpdateIva = parseFloat(document.getElementById("Lista25UpdateIva-" + index).value);
        //let set_lista25 = get_Lista25UpdateIva / 1.16;
        
        if (get_Lista25UpdateIva < CMex) {
            swal("Atención", "El Precio NO puede ser menor de CMEX", "error");
            
        }
    }
    /*********************************************/
    function Operacion14(STGP10, index) {
        let get_Lista14UpdateIva = parseFloat(document.getElementById("Lista14UpdateIva-" + index).value);
        let set_lista14 = get_Lista14UpdateIva / 1.16;
        $('#Lista14Update-' + index).val(set_lista14.toFixed(3));
        let vs_resta = set_lista14 - STGP10;
        let vs_division = vs_resta / set_lista14;
        let vs_porcentaje = (vs_division * 100).toFixed(3);
        $('#Lista14UpdateMargen-' + index).val('%'+vs_porcentaje);
    }
    /*********************************************/
    function Cell14OnBlur(CMex, index) {
        let get_Lista14UpdateIva = parseFloat(document.getElementById("Lista14UpdateIva-" + index).value);
        //let set_lista14 = get_Lista14UpdateIva / 1.16;
        
        if (get_Lista14UpdateIva < CMex) {
            swal("Atención", "El Precio NO puede ser menor de CMEX", "error");
            
        }
    }
    /*********************************************/
    function Operacion48(STGP10, index) {
        let get_Lista48UpdateIva = parseFloat(document.getElementById("Lista48UpdateIva-" + index).value);
        let set_lista48 = get_Lista48UpdateIva / 1.16;
        $('#Lista48Update-' + index).val(set_lista48.toFixed(3));
        let vs_resta = set_lista48 - STGP10;
        let vs_division = vs_resta / set_lista48;
        let vs_porcentaje = (vs_division * 100).toFixed(3);
        $('#Lista48UpdateMargen-' + index).val('%'+vs_porcentaje);
    }
    /*********************************************/
    function Cell48OnBlur(CMex, index) {
        let get_Lista48UpdateIva = parseFloat(document.getElementById("Lista48UpdateIva-" + index).value);
        //let set_lista48 = get_Lista48UpdateIva / 1.16;        
        if (get_Lista48UpdateIva < CMex) {
            swal("Atención", "El Precio NO puede ser menor de CMEX", "error");
            
        }
    }
    /*********************************************/
    function Operacion47(STGP10, index) {
        let get_Lista47UpdateIva = parseFloat(document.getElementById("Lista47UpdateIva-" + index).value);
        let set_lista47 = get_Lista47UpdateIva / 1.16;
        $('#Lista47Update-' + index).val(set_lista47.toFixed(3));
        let vs_resta = set_lista47 - STGP10;
        let vs_division = vs_resta / set_lista47;
        let vs_porcentaje = (vs_division * 100).toFixed(3);
        $('#Lista47UpdateMargen-' + index).val('%'+vs_porcentaje);
    }
    /*********************************************/
    function Cell47OnBlur(CMex, index) {
        let get_Lista47UpdateIva = parseFloat(document.getElementById("Lista47UpdateIva-" + index).value);
        //let set_lista47 = get_Lista47UpdateIva / 1.16;
        
        if (get_Lista47UpdateIva < CMex) {
            swal("Atención", "El Precio NO puede ser menor de CMEX", "error");
           
        }
    }
    /*********************************************/
    function Operacion29(STGP10, index) {
        let get_Lista29UpdateIva = parseFloat(document.getElementById("Lista29UpdateIva-" + index).value);
        let set_lista29 = get_Lista29UpdateIva / 1.16;
        let get_Lista15 = parseFloat(document.getElementById("Lista15Update-" + index).value);
        $('#Lista29Update-' + index).val(set_lista29.toFixed(3));
        let vs_resta = set_lista29 - get_Lista15;
        let vs_division = vs_resta / set_lista29;
        let vs_porcentaje = vs_division * 100;
        $('#Lista29UpdateMargen-' + index).val('%'+vs_porcentaje);
    }
    /*********************************************/
    function Cell29OnBlur(CMex, index) {
        let get_Lista29UpdateIva = parseFloat(document.getElementById("Lista29UpdateIva-" + index).value);
        //let set_lista29 = get_Lista29UpdateIva / 1.16;
        
        if (get_Lista29UpdateIva < CMex) {
            swal("Atención", "El Precio NO puede ser menor de CMEX", "error");
           
        }
    }
    /*********************************************/
    function Operacion28(STGP10, index) {
        let get_Lista28UpdateIva = parseFloat(document.getElementById("Lista28UpdateIva-" + index).value);
        let set_lista28 = get_Lista28UpdateIva / 1.16;
        let get_Lista15 = parseFloat(document.getElementById("Lista15Update-" + index).value);
        $('#Lista28Update-' + index).val(set_lista28.toFixed(3));
        let vs_resta = set_lista28 - get_Lista15;
        let vs_division = vs_resta / set_lista28;
        let vs_porcentaje = (vs_division * 100).toFixed(3);
        $('#Lista28UpdateMargen-' + index).val('%'+vs_porcentaje);
    }
    /*********************************************/
    function Cell28OnBlur(CMex, index) {
        let get_Lista28UpdateIva = parseFloat(document.getElementById("Lista28UpdateIva-" + index).value);
        let set_lista28 = get_Lista28UpdateIva / 1.16;
        
        if (get_Lista28UpdateIva < CMex) {
            swal("Atención", "El Precio NO puede ser menor de CMEX", "error");
            
        }
    }
    /*********************************************/
    function Operacion22(STGP10, index) {

        let get_Lista22UpdateIva = parseFloat(document.getElementById("Lista22UpdateIva-" + index).value);
        let set_lista22 = (get_Lista22UpdateIva / 1.16).toFixed(3);
        $('#Lista22Update-' + index).val(set_lista22);
        let vs_resta22 = set_lista22 - STGP10;

        let vs_division22 = vs_resta22 / set_lista22;
        let vs_porcentaje22 = (vs_division22 * 100).toFixed(3);

        $('#Lista22UpdateMargen-' + index).val('%' + vs_porcentaje22);
    }
    /*********************************************/

    function Cell22OnBlur(CMex, index) {

        let get_Lista22UpdateIva = parseFloat(document.getElementById("Lista22UpdateIva-" + index).value);
        //let set_lista33 = get_Lista33UpdateIva / 1.16;             

        if (get_Lista22UpdateIva < CMex) {
            swal("Atención", "El Precio NO puede ser menor del cMex ", "error");
        }
    }
    /*********************************************/
    function Operacion42(STGP10, index) {

        let get_Lista42UpdateIva = parseFloat(document.getElementById("Lista42UpdateIva-" + index).value);
        let set_lista42 = (get_Lista42UpdateIva / 1.16).toFixed(3);
        $('#Lista42Update-' + index).val(set_lista42);
        let vs_resta42 = set_lista42 - STGP10;

        let vs_division42 = vs_resta42 / set_lista42;
        let vs_porcentaje42 = (vs_division42 * 100).toFixed(3);

        $('#Lista42UpdateMargen-' + index).val('%' + vs_porcentaje42);
    }
    /*********************************************/

    function Cell42OnBlur(CMex, index) {

        let get_Lista42UpdateIva = parseFloat(document.getElementById("Lista42UpdateIva-" + index).value);
        //let set_lista33 = get_Lista33UpdateIva / 1.16;             

        if (get_Lista42UpdateIva < CMex) {
            swal("Atención", "El Precio NO puede ser menor del cMex ", "error");
        }
    }
    /*********************************************/
    //function inversaMayoreoTiendasForaneas(Lista10, index) {
    //    let get_lista_25_iva = parseFloat(document.getElementById("Lista25UpdateIva-" + index).value);
    //    let r_get_lista_25_iva = get_lista_25_iva / 1.16;
    //    let clean_25 = r_get_lista_25_iva;
    //    $('#Lista25Update-' + index).val(r_get_lista_25_iva);
    //    let get_lista_25 = clean_25;
    //    let vs_resta = get_lista_25 - Lista10;
    //    let vs_division = vs_resta / get_lista_25;
    //    let vs_porcentaje = vs_division * 100;
    //    $('#Lista25UpdateMargen-' + index).val(formatNumber.new(vs_porcentaje.toFixed(3)));
    //    underPriceMayoreoTiendasForaneas(Lista10, r_get_lista_25_iva, index);
    //}
    /*********************************************/
    //function inversaPublicoSucWeb(Lista10, index) {
    //    let get_lista_14_iva = parseFloat(document.getElementById("Lista14UpdateIva-" + index).value);
    //    let r_get_lista_14_iva = get_lista_14_iva / 1.16;
    //    let clean_14 = r_get_lista_14_iva;
    //    $('#Lista14Update-' + index).val(r_get_lista_14_iva);
    //    let get_lista_14 = clean_14;
    //    let vs_resta = get_lista_14 - Lista10;
    //    let vs_division = vs_resta / get_lista_14;
    //    let vs_porcentaje = vs_division * 100;
    //    $('#Lista14UpdateMargen-' + index).val(formatNumber.new(vs_porcentaje.toFixed(3)));
    //    underPricePublicoSucWeb(Lista10, r_get_lista_14_iva, index);
    //}
    /*********************************************/
    //function  (Lista10, Frn, index) {
    //    let get_lista_29_iva = parseFloat(document.getElementById("Lista29UpdateIva-" + index).value);
    //    let r_get_lista_29_iva = get_lista_29_iva / 1.16;
    //    $('#Lista29Update-' + index).val(r_get_lista_29_iva);
    //    let margen_resta = get_lista_29_iva - Frn;
    //    let margen_division = margen_resta / get_lista_29_iva;
    //    let vs_porcentaje = margen_division * 100;
    //    $('#Lista29UpdateMargen-' + index).val(formatNumber.new(vs_porcentaje.toFixed(3)));
    //    underPriceMayoreoFranquicias(Lista10, r_get_lista_29_iva, index);
    //}
    /*********************************************/
    //function inversaPublicoFranquicias(Lista10, Frn, index) {
    //    let get_lista_28_iva = parseFloat(document.getElementById("Lista28UpdateIva-" + index).value);
    //    let r_get_lista_28_iva = get_lista_28_iva / 1.16;
    //    $('#Lista28Update-' + index).val(r_get_lista_28_iva);
    //    let margen_resta = get_lista_28_iva - Frn;
    //    let margen_division = margen_resta / get_lista_28_iva;
    //    let vs_porcentaje = margen_division * 100;
    //    $('#Lista28UpdateMargen-' + index).val(formatNumber.new(vs_porcentaje.toFixed(3)));
    //    underPricePublicoFranquicias(Lista10, r_get_lista_28_iva, index);
    //}
    /*********************************************/
    //function underPriceMayoreoTiendasLocales(Lista10, r_get_lista_33_iva, index) {
    //    $("#legend-under-price-mtl-" + index).empty();
    //    if (r_get_lista_33_iva < Lista10) {
    //        //$(".td-mtl-" + index).addClass("underPrice");
    //        $("#legend-under-price-mtl-" + index).append("Debajo VS Costo");
    //    } else {
    //        $(".td-mtl-" + index).removeClass("underPrice");
    //        $("#legend-under-price-mtl-" + index).empty();
    //    }
    //}
    /*********************************************/
    //function underPriceMayoreoTiendasForaneas(Lista10, r_get_lista_25_iva, index) {
    //    $("#legend-under-price-mf-" + index).empty();
    //    if (r_get_lista_25_iva < Lista10) {
    //       // $(".td-mf-" + index).addClass("underPrice");
    //        $("#legend-under-price-mf-" + index).append("Debajo VS Costo");
    //    } else {
    //        $(".td-mf-" + index).removeClass("underPrice");
    //        $("#legend-under-price-mf-" + index).empty();
    //    }
    //}
    /*********************************************/
    //function underPricePublicoSucWeb(Lista10, r_get_lista_25_iva, index) {
    //    $("#legend-under-price-psw-" + index).empty();
    //    if (r_get_lista_25_iva < Lista10) {
    //       // $(".td-psw-" + index).addClass("underPrice");
    //        $("#legend-under-price-psw-" + index).append("Debajo VS Costo");
    //    } else {
    //        $(".td-psw-" + index).removeClass("underPrice");
    //        $("#legend-under-price-psw-" + index).empty();
    //    }
    //}
    /*********************************************/
    //function underPriceMayoreoFranquicias(Lista10, r_get_lista_29_iva, index) {
    //    $("#legend-under-price-mfr-" + index).empty();
    //    if (r_get_lista_29_iva < Lista10) {
    //        //$(".td-mfr-" + index).addClass("underPrice");
    //        $("#legend-under-price-mfr-" + index).append("Debajo VS Costo");
    //    } else {
    //        $(".td-mfr-" + index).removeClass("underPrice");
    //        $("#legend-under-price-mfr-" + index).empty();
    //    }
    //}
    /*********************************************/
    //function underPricePublicoFranquicias(Lista10, r_get_lista_28_iva, index) {
    //    $("#legend-under-price-pfr-" + index).empty();
    //    if (r_get_lista_28_iva < Lista10) {
    //       // $(".td-pfr-" + index).addClass("underPrice");
    //        $("#legend-under-price-pfr-" + index).append("Debajo VS Costo");
    //    } else {
    //        $(".td-pfr-" + index).removeClass("underPrice");
    //        $("#legend-under-price-pfr-" + index).empty();
    //    }
    //}
    /*********************************************/
    function showTr(index) {
        
        $(".hidden-price-id-" + index).show();
    }
    /*********************************************/
    function hideTr(index) {
        
        $(".hidden-price-id-" + index).hide();
    }
    /*********************************************/
    function changeColorValidaProductoSincronizado(index) {
        var NombreProducto = $("#NombreProducto-" + index).val();
        var NombreFamilia = $("#input-familia-" + index).val();
        if (NombreProducto == '' || NombreFamilia == '') {
            $("#tr-change-color-" + index).css("color", "red");
            
        }
    }
    /*********************************************/
    function changeColorEstatusFamilia(index) {
        var FamiliaAsignada = $("#estatus-familia-" + index).val();
        if (FamiliaAsignada == 1) {
            $("#td-ar-familia-" + index).css("background-color", "rgb(180, 213, 245)");
            $("#button-aprove-famiy-" + index).prop("disabled", true);
        } else if (FamiliaAsignada == 3) {
            $("#td-ar-familia-" + index).css("background-color", "#ed9e81");
            $("#button-reject-famiy-" + index).prop("disabled", true);
        }
    }
    /*********************************************/
    //Pasa el valor del SKU al modal para asignar familia
    $('#myModalFamilia').on('show.bs.modal', function (e) {
        var id = $(e.relatedTarget).data().id;
        $(e.currentTarget).find('#Sku').val(id);
    });
    //Limpia la tabla de la lista de precios de bussines
    function clearTableModificados() {
        var table = $('#precios-modificados-all').DataTable();
        table.clear().draw();
    }
    //Valida unicamente numeros
    function isNumberKey(evt) {
        var charCode = (evt.which) ? evt.which : event.keyCode
        if (charCode > 31 && (charCode < 48 || charCode > 57))
            return false;
        return true;
    }
    //Valida que no existan letras
    $(document).on("keyup", ".decimal", function () {
        var val = $(this).val();
        if (isNaN(val)) {
            val = val.replace(/[^0-9\.]/g, '');
            if (val.split('.').length > 2)
                val = val.replace(/\.+$/, "");
        }
        $(this).val(val);
    });
    //Tabla de referencia movinle
    $('.click').click(function () {
        $('#reference-table').show();
        $('#reference-table').draggable();
    });
    $('#close-reference-price').click(function () {
        $('#reference-table').hide();
    });
    //Genera excel de busqueda de sku
    $("#btn-DetalleSku").click(function () {
        var ItemCode = $('#ItemCode').val();
        $.post('@Url.Action("ListaPreciosProductosExcel", "Precios")', {
            ItemCode
            }, function (data) {
                window.location.href = '@Url.Action("Download", "Precios")' + '?fileGuid=' + data.FileGuid + '&fileName=' + data.FileName;
            });
    });
    //Formato de dinero
    var formatNumber = {
        separador: ",",
        sepDecimal: '.',
        formatear: function (num) {
            num += '';
            var splitStr = num.split('.');
            var splitLeft = splitStr[0];
            var splitRight = splitStr.length > 1 ? this.sepDecimal + splitStr[1] : '';
            var regx = /(\d+)(\d{3})/;
            while (regx.test(splitLeft)) {
                splitLeft = splitLeft.replace(regx, '$1' + this.separador + '$2');
            }
            return this.simbol + splitLeft + splitRight;
        },
        new: function (num, simbol) {
            this.simbol = simbol || '';
            return this.formatear(num);
        }
    }
    //Datatables del bussines
    $('#precios-modificados-all').DataTable({
        "dom": 'Bfrtip',
        "buttons": ['copy', 'excel', 'pdf', 'print'],
        "language": {
            "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json"
        },
        "order": false,
    });
</script>