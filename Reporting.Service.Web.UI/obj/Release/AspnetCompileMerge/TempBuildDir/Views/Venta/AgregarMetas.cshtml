@model Reporting.Service.Web.UI.Models.UserModel
@using Reporting.Service.Core.Common

@{
    ViewBag.Title = "AgregarMetas";
}

<section class="content-header">
    <h1>
        Agregar Metas
        <small>Panel de control</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Reporte SAP</a></li>
        <li class="active">AgregarMetas</li>
    </ol>
</section>

<section class="content">

    <div class="row">
        <div class="col-md-4">
            <div class="box box-danger">
                <div class="box-header with-border">
                    <i class="fa fa-bar-chart-o"></i>

                    <h3 class="box-title">Vendedor</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <form class="form">
                        <div class="form-group">
                            <div class="input-group">
                                <div class="input-group-addon">
                                    <span class="glyphicon glyphicon-search"></span>
                                </div>
                                <input type="text" class="form-control" id="Vendedor" placeholder="Nombre del vendedor">
                            </div>
                        </div>
                        @*<div id="buscar" class="btn btn-block btn-success">Buscar</div>*@
                        @*<br />*@
                        <div class="panel panel-default">
                            <div class="panel-heading">Vendedores encontrados</div>

                            <table class="table table-bordered">

                                <tbody id="content"></tbody>
                            </table>

                        </div>
                    </form>


                </div>
                <!-- /.box-body-->
            </div>
        </div>

        <div class="col-md-8">
            <div class="box box-danger">
                <div class="box-header with-border">
                    <i class="fa fa-bar-chart-o"></i>

                    <h3 class="box-title">Vendedor: <span class="Bold" id="NombreVendedor"></span> </h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>

                <div class="box-body">
                    <div class="row">

                        <div class="col-md-11">
                            <div class="table-responsive">

                                <table class="table ">
                                    <thead>
                                        <tr>
                                            <th style="width:40%"></th>
                                            <th class="text-center">Anterior</th>
                                            <th class="text-center">Actual</th>
                                            <th class="text-center">           </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <th class="text-right">Monto de la Meta:</th>
                                            <td><span id="MetaAnioAnterior"></span></td>
                                            <td><span id="Meta"></span></td>
                                            <td class="box-title">
                                                <input type="number" onkeypress='return validaNumericos(event)' class="form-control" id="Vendedor" placeholder="Meta a añadir">
                                            </td>
                                        </tr>
                                        <tr>
                                            <th class="text-right">Fecha:</th>
                                            <td class="box-title">

                                                                    <div class="input-group date">
                                                                        <div class="input-group-addon">
                                                                            <i class="fa fa-calendar"></i>
                                                                        </div>
                                                                        <input type="text" class="form-control pull-right" id="datepicker">
                                                                    </div>

                                            </td>
                                        </tr>

                                    </tbody>
                                 </table>

                                <center>
                                    <div id="DownloadClientes" class="btn btn-danger btn-blue">
                                        <span class="fa fa-arrow-circle-up"> Agregar </span>
                                    </div>
                                </center>

                            </div>
                        </div>
                        
                    </div>
                </div>
                <!-- /.box-body-->
            </div>
        </div>

    </div>

        <script>
             function FindInformacionVentaVendedor(Sequence) {

        FindInformacionClientes(Sequence);
        $("#SequenceVendedor").val(Sequence);
        $("#MontoPorCliente").html('');
        $("#MontoPorEstado").html('');
        $("#MontoPorCiudad").html('');

        $("#MontoPorClienteHead").html('');
        $("#MontoPorEstadoHead").html('');
        $("#MontoPorCiudadHead").html('');

        $("#MontoPorClienteHead").append('<tr>\
                                            <th>Ranking</th>\
                                            <th>Nombre</th>\
                                            <th>Factura Anterior</th>\
                                            <th>Carta Factura Anterior</th>\
                                            <th>Factura</th>\
                                            <th>Carta Factura</th>\
                                            <th>Total</th>\
                                        </tr>');
        $("#MontoPorEstadoHead").append('<tr>\
                                            <th>Ranking</th>\
                                            <th>Nombre</th>\
                                            <th>Factura Anterior</th>\
                                            <th>Carta Factura Anterior</th>\
                                            <th>Factura</th>\
                                            <th>Carta Factura</th>\
                                            <th>Total</th>\
                                        </tr>');
        $("#MontoPorCiudadHead").append('<tr>\
                                            <th>Ranking</th>\
                                            <th>Nombre</th>\
                                            <th>Factura Anterior</th>\
                                            <th>Carta Factura Anterior</th>\
                                            <th>Factura</th>\
                                            <th>Carta Factura</th>\
                                            <th>Total</th>\
                                        </tr>');
        $("#VF").html('0');
        $("#CF").html('0');
        $("#Total").html('0');
        $("#Cumpliento").html('0 %');
        $("#Ranking").html('0');
        $("#Meta").html('0');
        $("#ImgVendedor").attr("src", "")
        $("#NombreVendedor").html('');
        $.post('@Url.Action("InformacionVentas", "Venta")', {
            Sequence: Sequence
        }, function (data) {
            if (data != null) {
                console.log(data);
                //var VP1 = $('#TablaMonto').DataTable();
                //VP1.destroy();
                //var VP2 = $('#TablaEstado').DataTable();
                //VP2.destroy();
                //var VP3 = $('#TablaCiudad').DataTable();
                //VP3.destroy();

                $("#NombreVendedor").html(data.Context.Nombre);
                $("#Meta").html(formatNumber.new(data.Context.Meta.toFixed(2), "$"));
                $("#MetaAnioAnterior").html(formatNumber.new(data.Context.MetaAnioAnterior.toFixed(2), "$"));
                $("#CartaFactura").html(formatNumber.new(data.Context.CartaFactura.toFixed(2), "$"));
                $("#Factura").html(formatNumber.new(data.Context.Factura.toFixed(2), "$"));
                $("#CartaFacturaAñoPasado").html(formatNumber.new(data.Context.CartaFacturaAñoPasado.toFixed(2), "$"));
                $("#FacturaAñoPasado").html(formatNumber.new(data.Context.FacturaAñoPasado.toFixed(2), "$"));
                $("#TotalActual").html(formatNumber.new((data.Context.CartaFactura + data.Context.Factura).toFixed(2), "$"));
                $("#TotalAnterior").html(formatNumber.new((data.Context.CartaFacturaAñoPasado + data.Context.FacturaAñoPasado).toFixed(2), "$"));
                $("#NoPedidosActuales").html(data.Context.NoPedidosActuales);
                $("#NoPedidosAnteriores").html(data.Context.NoPedidosAnteriores);
                $("#PromedioPorPedidoActual").html(formatNumber.new(data.Context.PromedioPorPedidoActual.toFixed(2), "$"));
                $("#PromedioPorPedidoAnterior").html(formatNumber.new(data.Context.PromedioPorPedidoAnterior.toFixed(2), "$"));
                $("#NoClientesActuales").html(data.Context.NoClientesActuales);
                $("#NoClientesAnteriores").html(data.Context.NoClientesAnteriores);

                $("#Fecha_Meta").html(formatNumber.new(data.Context.PromedioMontoPorClienteActual.toFixed(2), "$"));
                $("#Monto").html(formatNumber.new(data.Context.PromedioMontoPorClienteAnterior.toFixed(2), "$"));


                } else {
                $.alert("Ocurrio un error al procesar la solicitud");
            }
        });
    }

            //Date picker
            $('#datepicker').datepicker({
                autoclose: true
            });

            var formatNumber = {
                separador: ",", // separador para los miles
                sepDecimal: '.', // separador para los decimales
                formatear: function (num) {
                    num += '';
                    var splitStr = num.split('.');
                    var splitLeft = splitStr[0];
                    var splitRight = splitStr.length > 1 ? this.sepDecimal + splitStr[1] : '';
                    var regx = /(\d+)(\d{3})/;
                    while (regx.test(splitLeft)) {
                        splitLeft = splitLeft.replace(regx, '$1' + this.separador + '$2');
                    }
                    return this.simbol + splitLeft + splitRight;
                },
                new: function (num, simbol) {
                    this.simbol = simbol || '';
                    return this.formatear(num);
                }
            }
        </script>


        <script>


        $("#Vendedor").on('keyup', function (e) {

            FindVendedor();
        });

        function FindVendedor() {
            //$.confirm({
            //    title: '¡Confirmar!',
            //    content: 'Se procedera a buscar al vendedor: ' + $("#Vendedor").val(),
            //    type: 'blue',
            //    buttons: {
            //        confirm: {
            //            text: 'Confirmar',
            //            action: function () {
            $.post('@Url.Action("BuscarVendedor", "Evaluacion")', {
                Vendedor: $("#Vendedor").val()
            }, function (data) {

                $("#content").html('');
                /* Vemos que la respuesta no este vacía y sea una arreglo */
                if (data != null && $.isArray(data.Context)) {
                    /* Recorremos tu respuesta con each */
                    $.each(data.Context, function (index, value) {
                        /* Vamos agregando a nuestra tabla las filas necesarias */
                        $("#content").append("<tr><td class='hidden'>" + value.Sequence + "</td><td>" + value.Nombre + "</td><td><div onclick='getDetalleVendedor(" + value.Sequence + ")' class='btn btn-info'><span class='glyphicon glyphicon-eye-open'></span> Detalles</div></td></tr>");
                        //console.log(value.Sequence);
                        //console.log(value.Nombre);
                    });
                } else {
                    $.alert("No se encontro ningun vendendor con el nombre: " + $("#Vendedor").val());
                }

                document.getElementById("myForm").reset();
            });
            //            }
            //        },
            //        cancel: {
            //            text: 'Cancelar',
            //            action: function () {
            //                $.alert('El proceso ha sido cancelado')
            //            }
            //        }
            //    }
            //});
        }
        $("#buscar").click(function () {
            FindVendedor();
        });


        function getDetalleVendedor(Sequence) {
            @*$.post('@Url.Action("DetalleAgente", "Evaluacion")', {
                Vendedor: Sequence
            }, function (data) {
                if (data != null) {
                    $("#MetaActual").html('')
                    $("#VentaActual").html('')
                    $("#VentaAnualActual").html('')
                    $("#VentaAnualAnterior").html('')

                    $("#MetaActual").html(formatNumber.new(data.Context.MetaDelMes.toFixed(2), "$"))
                    $("#VentaActual").html(formatNumber.new(data.Context.MontoDelMes.toFixed(2), "$"))
                    $("#VentaAnualActual").html(formatNumber.new(data.Context.MontoDelAño.toFixed(2), "$"))
                    $("#VentaAnualAnterior").html(formatNumber.new(data.Context.MontoDelAñoPasado.toFixed(2), "$"))
                    $("#ImgVendedor").attr("src", "http://192.168.2.188/Imagenes/Vendedores/" + Sequence + ".jpg")
                    $("#NombreVendedor").html(data.Context.Nombre);

                } else {
                    $.alert("No se encontro ningun vendendor con el nombre: ");
                }
            });*@
            $.post('@Url.Action("InformacionVentas", "Venta")', {
                Sequence: Sequence
            }, function (data) {
                if (data != null) {
                    console.log(data);

                    $("#NombreVendedor").html(data.Context.Nombre);
                    $("#Meta").html(formatNumber.new(data.Context.Meta.toFixed(2), "$"));
                    $("#MetaAnioAnterior").html(formatNumber.new(data.Context.MetaAnioAnterior.toFixed(2), "$"));
                    $("#CartaFactura").html(formatNumber.new(data.Context.CartaFactura.toFixed(2), "$"));
                    $("#Factura").html(formatNumber.new(data.Context.Factura.toFixed(2), "$"));
                    $("#CartaFacturaAñoPasado").html(formatNumber.new(data.Context.CartaFacturaAñoPasado.toFixed(2), "$"));
                    $("#FacturaAñoPasado").html(formatNumber.new(data.Context.FacturaAñoPasado.toFixed(2), "$"));
                    $("#TotalActual").html(formatNumber.new((data.Context.CartaFactura + data.Context.Factura).toFixed(2), "$"));
                    $("#TotalAnterior").html(formatNumber.new((data.Context.CartaFacturaAñoPasado + data.Context.FacturaAñoPasado).toFixed(2), "$"));
                    $("#NoPedidosActuales").html(data.Context.NoPedidosActuales);
                    $("#NoPedidosAnteriores").html(data.Context.NoPedidosAnteriores);
                    $("#PromedioPorPedidoActual").html(formatNumber.new(data.Context.PromedioPorPedidoActual.toFixed(2), "$"));
                    $("#PromedioPorPedidoAnterior").html(formatNumber.new(data.Context.PromedioPorPedidoAnterior.toFixed(2), "$"));
                    $("#NoClientesActuales").html(data.Context.NoClientesActuales);
                    $("#NoClientesAnteriores").html(data.Context.NoClientesAnteriores);
                    $("#PromedioMontoPorClienteActual").html(formatNumber.new(data.Context.PromedioMontoPorClienteActual.toFixed(2), "$"));
                    $("#PromedioMontoPorClienteAnterior").html(formatNumber.new(data.Context.PromedioMontoPorClienteAnterior.toFixed(2), "$"));

                    $("#ImgVendedor").attr("src", "https://192.168.2.188/Imagenes/Vendedores/" + Sequence + ".jpg")

                } else {
                    $.alert("Ocurrio un error al procesar la solicitud");
                }
            });
            getTopVentasEstados(Sequence);
            getTopVentasEstadoPorcentaje(Sequence);
            TopVentasVsClientes(Sequence);
        }
        function getTopVentasEstados(Sequence) {
            $.post('@Url.Action("VentasEstados", "Evaluacion")', {
                Vendedor: Sequence
            }, function (data) {
                if (data != null && $.isArray(data.Context)) {
                    var DatosArray = [];
                    $.each(data.Context, function (index, value) {
                        DatosArray.push([value.Estado, value.Monto]);
                    });

                    /*
                     * BAR CHART
                     * ---------
                     */
                    var bar_data = {
                        data: DatosArray,
                        color: "#3c8dbc"
                    };

                    $.plot("#bar-chart", [bar_data], {
                        grid: {
                            borderWidth: 1,
                            borderColor: "#f3f3f3",
                            tickColor: "#f3f3f3",
                            hoverable: true
                        },
                        series: {
                            bars: {
                                show: true,
                                barWidth: 0.5,
                                align: "center"
                            }
                        },
                        xaxis: {
                            mode: "categories",
                            tickLength: 0
                        }
                    });
                    //Initialize tooltip on hover
                    $('<div class="tooltip-inner" id="line-chart-tooltip"></div>').css({
                        position: "absolute",
                        display: "none",
                        opacity: 0.8
                    }).appendTo("body");
                    $("#bar-chart").bind("plothover", function (event, pos, item) {

                        if (item) {
                            var x = item.datapoint[0].toFixed(2),
                                y = item.datapoint[1].toFixed(2);
                            $("#line-chart-tooltip").html(formatNumber.new(item.series.data[parseInt(x)][1].toFixed(2), "$"))
                                .css({ top: item.pageY + 5, left: item.pageX + 5 })
                                .fadeIn(200);
                        } else {
                            $("#line-chart-tooltip").hide();
                        }

                    });
                    /* END BAR CHART */

                } else {
                    $.alert("No se encontro ningun vendendor con el nombre: ");
                }


            });
        }

        function getTopVentasEstadoPorcentaje(Sequence) {
            $.post('@Url.Action("ClientesEstadosPorcentaje", "Evaluacion")', {
                Vendedor: Sequence
            }, function (data) {

                if (data != null && $.isArray(data.Context)) {
                    /* Recorremos tu respuesta con each */
                    $("#donut-chart").html('');
                    $("#donut-chart").append('');

                    var DatosArray = [];
                    $.each(data.Context, function (index, value) {
                        DatosArray.push({ label: value.Estado + ' ' + value.Porcentaje.toFixed(2) + ' %', data: value.Porcentaje, color: dame_color_aleatorio() });
                    });

                    var donutData = DatosArray;

                    $.plot("#donut-chart", donutData, {
                        series: {
                            pie: {
                                show: true
                            }
                        },
                        grid: {
                            hoverable: true
                        },
                        legend: {
                            show: true,
                            labelFormatter: function (label, series) {
                                // series is the series object for the label
                                return '<label>' + label + '</label>';

                            }
                        }
                        //series: {
                        //    pie: {
                        //        show: true,
                        //        radius: 1,
                        //        label: {
                        //            show: true,
                        //            radius: 1,
                        //            formatter: labelFormatter,
                        //            background: {
                        //                opacity: 0.5,
                        //                color: '#000'
                        //            }
                        //        }
                        //    }
                        //},
                        //grid: {
                        //    hoverable: true
                        //},
                        //legend: {
                        //    show: false,
                        //},
                        //xaxis: {
                        //    mode: "categories",
                        //    tickLength: 0
                        //}
                    });
                } else {
                    $.alert("No se encontro ningun vendendor con el nombre: " + $("#Vendedor").val());
                }


            });
        }

        function TopVentasVsClientes(Sequence) {
            $.post('@Url.Action("VentasClientes", "Evaluacion")', {
                Vendedor: Sequence
            }, function (data) {

                $("#Ventasclientes").html('');
                /* Vemos que la respuesta no este vacía y sea una arreglo */
                if (data != null && $.isArray(data.Context)) {
                    /* Recorremos tu respuesta con each */
                    $.each(data.Context, function (index, value) {
                        /* Vamos agregando a nuestra tabla las filas necesarias */
                        $("#Ventasclientes").append("<tr><td style='font-weight: bold;'>" + value.Nombre + "</td><td >" + formatNumber.new(value.VentaAñoAnterior.toFixed(2), "$") + "</td><td >" + formatNumber.new(value.VentaAñoActual.toFixed(2), "$") + "</td><td >" + value.MesMayorVenta + "</td></tr>");
                        //console.log(value.Sequence);
                        //console.log(value.Nombre);
                    });
                } else {
                    $.alert("No se encontro ningun vendendor con el nombre: " + $("#Vendedor").val());
                }


            });
        }

        function validaNumericos(event) {
            if (event.charCode >= 48 && event.charCode <= 57) {
                return true;
            }
            return false;
        }

        function Fechalimitada() {

            $(document).ready(function () {

                //$('#datetimepicker').datetimepicker('setStartDate', '2016')

                $(function () {
                    $('#datetimepicker').datetimepicker({
                        minDate: '13/08/2018'
                    });
                });
            });
        }
        </script>


        <script>
    $("#ShowDetails").click(function () {

        var drp = $('#DelAl').data('daterangepicker');
        var Del = drp.startDate.format('YYYY/MM/DD');
        var Al = drp.endDate.format('YYYY/MM/DD');
        console.log(Del + ' ' + Al);

        $.confirm({
            title: '¡Confirmar!',
            content: '!Esto podria tomar unos segundos¡',
            type: 'blue',
            buttons: {
                confirm: {
                    text: 'Confirmar',
                    action: function () {
                        $('#ClientesRefresh').show();
                        $('#DecrementoArticuloRefresh').show();
                        $('#DecrementoClienteRefresh').show();
                        $('#PiezasSkuRefresh').show();
                        $('#PiezasClienteRefresh').show();

                        //Obtiene informacion de productos en 8020
                        $.post('@Url.Action("ListaProductos", "Productos")', {
                            Del: Del,
                            Al: Al
                        }, function (data) {
                            if (data != null && $.isArray(data.Context)) {
                                var table = $('#Clientes').DataTable();
                                table.destroy();
                                $("#DetalleClientes").html('');
                                $.each(data.Context, function (index, value) {
                                    $("#DetalleClientes").append("<tr>\
                                                                    <td>" + value.Sku + "</td>\
                                                                    <td>" + formatNumber.new(value.PeriodoActual.toFixed(2), "$") + "</td>\
                                                                    <td>" + formatNumber.new(value.PeriodoAnterior.toFixed(2), "$") + "</td>\
                                                                    <td>" + value.Crecimiento.toFixed(2) + "% </td>\
                                                                  </tr>");
                                });
                                $('#Clientes').DataTable({
                                    "paging": true,
                                    "lengthChange": true,
                                    "searching": true,
                                    "ordering": true,
                                    "info": true,
                                    "autoWidth": true,
                                    "language": {
                                        "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json"
                                    }
                                });
                                $('#ClientesRefresh').hide();

                            } else {
                                $.alert("No se encontraron registros");
                            }
                        });

                        //Obtiene informacion de decrementos
                        $.post('@Url.Action("DecrementoArticulos", "Productos")', {
                            Del: Del,
                            Al: Al
                        }, function (data) {
                            if (data != null && $.isArray(data.Context)) {
                                console.log(data)
                                var table = $('#DecrementoArticulo').DataTable();
                                table.destroy();
                                $("#DetalleDecrementoArticulo").html('');
                                $.each(data.Context, function (index, value) {
                                    $("#DetalleDecrementoArticulo").append("<tr>\
                                                                    <td>" + value.Sku + "</td>\
                                                                    <td>" + formatNumber.new(value.PeriodoActual.toFixed(0), "") + "</td>\
                                                                    <td>" + formatNumber.new(value.Monto.toFixed(2), "$") + "</td>\
                                                                    <td>" + formatNumber.new(value.PeriodoAnterior.toFixed(0), "") + "</td>\
                                                                    <td>" + formatNumber.new(value.MontoAnterior.toFixed(2), "$") + "</td>\
                                                                    <td>" + formatNumber.new(value.Stock.toFixed(0), "") + "</td>\
                                                                    <td>" + formatNumber.new(value.Estado, "") + "</td>\
                                                                  </tr>");
                                });
                                $('#DecrementoArticulo').DataTable({
                                    "paging": true,
                                    "lengthChange": true,
                                    "searching": true,
                                    "ordering": true,
                                    "info": true,
                                    "autoWidth": true,
                                    "language": {
                                        "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json"
                                    }
                                });
                                $('#DecrementoArticuloRefresh').hide();

                            } else {
                                $.alert("No se encontraron registros");
                            }
                        });

                        //Obtiene informacion de decrementos de clientes
                        $.post('@Url.Action("DecrementoCliente", "Productos")', {
                            Del: Del,
                            Al: Al
                        }, function (data) {
                            if (data != null && $.isArray(data.Context)) {
                                console.log(data)
                                var table = $('#DecrementoCliente').DataTable();
                                table.destroy();
                                $("#DetalleDecrementoCliente").html('');
                                $.each(data.Context, function (index, value) {
                                    $("#DetalleDecrementoCliente").append("<tr>\
                                                                    <td>" + value.Cliente + "</td>\
                                                                    <td>" + formatNumber.new(value.PeriodoActual.toFixed(0), "") + "</td>\
                                                                    <td>" + formatNumber.new(value.PeriodoAnterior.toFixed(0), "") + "</td>\
                                                                    <td>" + formatNumber.new(value.Participacion.toFixed(2), "") + " %</td>\
                                                                    <td>" + formatNumber.new(value.Estado, "") + "</td>\
                                                                    <td>" + formatNumber.new(value.Tipo, "") + "</td>\
                                                                  </tr>");
                                });
                                $('#DecrementoCliente').DataTable({
                                    "paging": true,
                                    "lengthChange": true,
                                    "searching": true,
                                    "ordering": true,
                                    "info": true,
                                    "autoWidth": true,
                                    "language": {
                                        "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json"
                                    }
                                });
                                $('#DecrementoClienteRefresh').hide();

                            } else {
                                $.alert("No se encontraron registros");
                            }
                        });




                    }
                },
                cancel: {
                    text: 'Cancelar',
                    action: function () {
                        $.alert('El proceso ha sido cancelado')
                    }
                }
            }
        });
    });
    var formatNumber = {
        separador: ",", // separador para los miles
        sepDecimal: '.', // separador para los decimales
        formatear: function (num) {
            num += '';
            var splitStr = num.split('.');
            var splitLeft = splitStr[0];
            var splitRight = splitStr.length > 1 ? this.sepDecimal + splitStr[1] : '';
            var regx = /(\d+)(\d{3})/;
            while (regx.test(splitLeft)) {
                splitLeft = splitLeft.replace(regx, '$1' + this.separador + '$2');
            }
            return this.simbol + splitLeft + splitRight;
        },
        new: function (num, simbol) {
            this.simbol = simbol || '';
            return this.formatear(num);
        }
    }

    $('#DelAl').daterangepicker({
        locale: {
            cancelLabel: 'Clear',
            daysOfWeek: [
                "Do",
                "Lu",
                "Ma",
                "Mi",
                "Ju",
                "Vi",
                "Sa"
            ],
            monthNames: [
                 "Enero",
                 "Febrero",
                 "Marzo",
                 "Abril",
                 "Mayo",
                 "Junio",
                 "Julio",
                 "Agosto",
                 "Septiembre",
                 "Octubre",
                 "Noviembre",
                 "Deciembre"
            ]
        }

    });

    $("#DownloadProductos8020").click(function () {
        var drp = $('#DelAl').data('daterangepicker');
        var Del = drp.startDate.format('YYYY/MM/DD');
        var Al = drp.endDate.format('YYYY/MM/DD');

        $.confirm({
            title: '¡Confirmar!',
            content: 'Decargar el archivo podria tomar algunos segundos.',
            type: 'blue',
            buttons: {
                confirm: {
                    text: 'Confirmar',
                    action: function () {
                        $('#ClientesRefresh').show();
                        $.post('@Url.Action("ExcelProductos", "Productos")', {
                            Del: Del,
                            Al: Al
                        }, function (data) {
                            console.log(data)
                            //window.location = '../' + data.FileName;
                            window.location.href = '@Url.Action("Download", "Clientes")' + '?fileGuid=' + data.FileGuid + '&fileName=' + data.FileName;
                            $('#ClientesRefresh').hide();
                        });
                    }
                },
                cancel: {
                    text: 'Cancelar',
                    action: function () {
                        $.alert('El proceso ha sido cancelado')
                    }
                }
            }
        });
    });
    $("#DownloadProductosDecremento").click(function () {
        var drp = $('#DelAl').data('daterangepicker');
        var Del = drp.startDate.format('YYYY/MM/DD');
        var Al = drp.endDate.format('YYYY/MM/DD');

        $.confirm({
            title: '¡Confirmar!',
            content: 'Decargar el archivo podria tomar algunos segundos.',
            type: 'blue',
            buttons: {
                confirm: {
                    text: 'Confirmar',
                    action: function () {
                        $('#DecrementoArticuloRefresh').show();
                        $.post('@Url.Action("ExcelDecrementoArticulos", "Productos")', {
                            Del: Del,
                            Al: Al
                        }, function (data) {
                            console.log(data)
                            //window.location = '../' + data.FileName;
                            window.location.href = '@Url.Action("Download", "Clientes")' + '?fileGuid=' + data.FileGuid + '&fileName=' + data.FileName;
                            $('#DecrementoArticuloRefresh').hide();
                        });
                    }
                },
                cancel: {
                    text: 'Cancelar',
                    action: function () {
                        $.alert('El proceso ha sido cancelado')
                    }
                }
            }
        });
    });

    $("#DownloadDecrementoCliente").click(function () {
        var drp = $('#DelAl').data('daterangepicker');
        var Del = drp.startDate.format('YYYY/MM/DD');
        var Al = drp.endDate.format('YYYY/MM/DD');

        $.confirm({
            title: '¡Confirmar!',
            content: 'Decargar el archivo podria tomar algunos segundos.',
            type: 'blue',
            buttons: {
                confirm: {
                    text: 'Confirmar',
                    action: function () {
                        $('#DecrementoClienteRefresh').show();
                        $.post('@Url.Action("ExcelDecrementoCliente", "Productos")', {
                            Del: Del,
                            Al: Al
                        }, function (data) {
                            console.log(data)
                            //window.location = '../' + data.FileName;
                            window.location.href = '@Url.Action("Download", "Clientes")' + '?fileGuid=' + data.FileGuid + '&fileName=' + data.FileName;
                            $('#DecrementoClienteRefresh').hide();
                        });
                    }
                },
                cancel: {
                    text: 'Cancelar',
                    action: function () {
                        $.alert('El proceso ha sido cancelado')
                    }
                }
            }
        });
    });


    $("#DownloadPiezasSku").click(function () {
        var drp = $('#DelAl').data('daterangepicker');
        var Del = drp.startDate.format('YYYY/MM/DD');
        var Al = drp.endDate.format('YYYY/MM/DD');

        $.confirm({
            title: '¡Confirmar!',
            content: 'Decargar el archivo podria tomar algunos segundos.',
            type: 'blue',
            buttons: {
                confirm: {
                    text: 'Confirmar',
                    action: function () {
                        $('#PiezasSkuRefresh').show();
                        $.post('@Url.Action("ExcelPiezasPorSku", "Productos")', {
                            Del: Del,
                            Al: Al
                        }, function (data) {
                            console.log(data)
                            //window.location = '../' + data.FileName;
                            window.location.href = '@Url.Action("Download", "Clientes")' + '?fileGuid=' + data.FileGuid + '&fileName=' + data.FileName;
                            $('#PiezasSkuRefresh').hide();
                        });
                    }
                },
                cancel: {
                    text: 'Cancelar',
                    action: function () {
                        $.alert('El proceso ha sido cancelado')
                    }
                }
            }
        });
    });

    $("#DownloadPiezasCliente").click(function () {
        var drp = $('#DelAl').data('daterangepicker');
        var Del = drp.startDate.format('YYYY/MM/DD');
        var Al = drp.endDate.format('YYYY/MM/DD');

        $.confirm({
            title: '¡Confirmar!',
            content: 'Decargar el archivo podria tomar algunos segundos.',
            type: 'blue',
            buttons: {
                confirm: {
                    text: 'Confirmar',
                    action: function () {
                        $('#PiezasClienteRefresh').show();
                        $.post('@Url.Action("ExcelPiezasPorCliente", "Productos")', {
                            Del: Del,
                            Al: Al
                        }, function (data) {
                            console.log(data)
                            //window.location = '../' + data.FileName;
                            window.location.href = '@Url.Action("Download", "Clientes")' + '?fileGuid=' + data.FileGuid + '&fileName=' + data.FileName;
                            $('#PiezasClienteRefresh').hide();
                        });
                    }
                },
                cancel: {
                    text: 'Cancelar',
                    action: function () {
                        $.alert('El proceso ha sido cancelado')
                    }
                }
            }
        });
    });

        </script>


        
</section>
