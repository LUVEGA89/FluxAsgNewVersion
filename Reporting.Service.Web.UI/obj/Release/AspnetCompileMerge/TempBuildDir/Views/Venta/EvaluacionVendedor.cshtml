@model Reporting.Service.Web.UI.Models.UserModel
@using Reporting.Service.Core.Common

@{
    ViewBag.Title = "EvaluacionVendedor";
}

<section class="content-header">
    <h1>
        Ventas
        <small>Panel de control</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Reporte SAP</a></li>
        <li class="active">Ventas</li>
    </ol>
</section>

<section class="content">
    <div class="row">
        <div class="col-md-4">
            <div class="box box-danger">
                <div class="box-header with-border">
                    <i class="fa fa-bar-chart-o"></i>

                    <h3 class="box-title">Vendedor</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <form class="form" id="SeccionVendedor">
                        <div class="form-group">
                            <div class="input-group">
                                <div class="input-group-addon">
                                    <span class="glyphicon glyphicon-search"></span>
                                </div>
                                <input type="text" class="form-control" id="Vendedor" placeholder="Nombre del vendedor">
                            </div>
                        </div>
                        @*<div id="buscar" class="btn btn-block btn-success">Buscar</div>*@
                        @*<br />*@
                        <div class="panel panel-default">
                            <div class="panel-heading">Vendedores encontrados</div>

                            <table class="table table-bordered">

                                <tbody id="content"></tbody>
                            </table>

                        </div>
                    </form>

                </div>
                <div class="box-footer">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <div class="input-group">
                                    <div class="input-group-addon">
                                        <i class="fa fa-calendar"></i>
                                    </div>
                                    <input type="text" class="form-control pull-right" id="DelAl">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <div id="FCF" class="btn btn-default btn-block"><i class="fa  fa-file-excel-o"></i> Venta CF + F</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <div id="AgenteFCF" class="btn btn-default btn-block"><i class="fa  fa-file-excel-o"></i> Venta por agente </div>
                            </div>

                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <div id="AnalisisCompartivo" class="btn btn-default btn-block"><i class="fa  fa-file-excel-o"></i>Analisis comparativo por cliente</div>
                            </div>

                        </div>
                    </div>


                </div>
                <div id="VendedorWait" style="display:none;" class="overlay">
                    <i class="fa fa-circle-o-notch fa-spin"></i>
                </div>
            </div>
        </div>
        <div class="col-md-8">
            <div class="box box-danger">
                <div class="box-header with-border">
                    <i class="fa fa-bar-chart-o"></i>

                    <h3 class="box-title">Vendedor: <span class="Bold" id="NombreVendedor"></span> </h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>

                <div class="box-body">
                    <div class="row">
                        <div class="col-md-12">
                            <img id="ImgVendedor" src="dist/img/Users.png" class="img-circle center-block" alt="User Image">
                        </div><br />
                        <div class="col-md-12">
                            <p class="lead hide">Amount Due 2/22/2014</p>
                            <div class="table-responsive">

                                <table class="table ">
                                    <thead>
                                        <tr>
                                            <th style="width:40%"></th>
                                            <th class="text-center">Anterior</th>
                                            <th class="text-center">Actual</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <th class="text-right">Meta:</th>
                                            <td><span id="MetaAnioAnterior"></span></td>
                                            <td><span id="Meta"></span></td>
                                        </tr>
                                        <tr>
                                            <th class="text-right">Carta factura:</th>
                                            <td><span id="CartaFacturaAñoPasado"></span></td>
                                            <td><span id="CartaFactura"></span></td>
                                        </tr>
                                        <tr>
                                            <th class="text-right">Factura:</th>
                                            <td><span id="FacturaAñoPasado"></span></td>
                                            <td><span id="Factura"></span></td>
                                        </tr>
                                        <tr>
                                            <th class="text-right">Total:</th>
                                            <td><span id="TotalAnterior"></span></td>
                                            <td><span id="TotalActual"></span></td>
                                        </tr>
                                        <tr>
                                            <th class="text-right">Número de pedidos:</th>
                                            <td><span id="NoPedidosAnteriores"></span></td>
                                            <td><span id="NoPedidosActuales"></span></td>
                                        </tr>
                                        <tr>
                                            <th class="text-right">Monto promedio por pedidos:</th>
                                            <td><span id="PromedioPorPedidoAnterior"></span></td>
                                            <td><span id="PromedioPorPedidoActual"></span></td>
                                        </tr>
                                        <tr>
                                            <th class="text-right">Número de clientes por periodo:</th>
                                            <td><span id="NoClientesAnteriores"></span></td>
                                            <td><span id="NoClientesActuales"></span></td>
                                        </tr>
                                        <tr>
                                            <th class="text-right">Monto promedio por clientes:</th>
                                            <td><span id="PromedioMontoPorClienteAnterior"></span></td>
                                            <td><span id="PromedioMontoPorClienteActual"></span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="col-md-12 hide">
                            <input type="hidden" id="SequenceVendedor" />
                            <div class="form-group">
                                <label for="inputEmail3" class="col-sm-3 control-label">Filtro: </label>

                                <div class="col-sm-9">
                                    <select onchange="CambiarOperacion()" class="form-control" id="TipoOperacion2">
                                        <option value="1">Monto</option>
                                        <option value="2">Piezas</option>
                                        <option value="3">Oferta</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /.box-body-->
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6 hide">
            <div class="box box-danger">
                <div class="box-header with-border">
                    <i class="fa fa-bar-chart-o"></i>
                    <h3 class="box-title">Ventas por cliente</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="table table-responsive">
                        <table id="TablaMonto" class="table table-bordered">
                            <thead id="MontoPorClienteHead">
                                <tr>
                                    <th>Ranking</th>
                                    <th>Nombre</th>
                                    <th> Factura</th>
                                    <th>Carta Factura</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody id="MontoPorCliente"></tbody>
                        </table>
                    </div>
                </div>
                <!-- /.box-body-->
            </div>
        </div>
        <div class="col-md-6 hide">
            <div class="box box-danger">
                <div class="box-header with-border">
                    <i class="fa fa-bar-chart-o"></i>
                    <h3 class="box-title">Ventas por Estado</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="table table-responsive">
                        <table id="TablaEstado" class="table table-bordered">
                            <thead id="MontoPorEstadoHead">
                                <tr>
                                    <th>Ranking</th>
                                    <th>Estado</th>
                                    <th>Factura</th>
                                    <th>Carta Factura</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody id="MontoPorEstado"></tbody>
                        </table>
                    </div>
                </div>
                <!-- /.box-body-->
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6 hide">
            <div class="box box-danger">
                <div class="box-header with-border">
                    <i class="fa fa-bar-chart-o"></i>
                    <h3 class="box-title">Ventas por Ciudad</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="table table-responsive">
                        <table id="TablaCiudad" class="table table-bordered">
                            <thead id="MontoPorCiudadHead">
                                <tr>
                                    <th>Ranking</th>
                                    <th>Ciudad</th>
                                    <th>Factura</th>
                                    <th>Carta Factura</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody id="MontoPorCiudad"></tbody>
                        </table>
                    </div>
                </div>
                <!-- /.box-body-->
            </div>
        </div>
        <div class="col-md-12">
            <div class="box box-danger">
                <div class="box-header with-border">
                    <i class="fa fa-bar-chart-o"></i>
                    <h3 class="box-title">Detalle de clientes</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="table table-responsive">
                        <table id="Clientes" class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Ranking</th>
                                    <th>Codigo</th>
                                    <th>Nombre</th>
                                    <th>En 8020</th>
                                    <th>Estado</th>
                                    <th>Ciudad</th>
                                    <th>Monto</th>
                                </tr>
                            </thead>
                            <tbody id="ClientesDetalle"></tbody>
                        </table>
                    </div>
                </div>
                <!-- /.box-body-->
            </div>
        </div>
    </div>
</section>

<script>
   @if (Model.Roles.Contains(Rol.Ventas))
   {
       <text>
    GetDetalleVendedor();
    </text>
   }

    function GetDetalleVendedor() {
        $.post('@Url.Action("Vendedor", "Venta")', function (data) {
            console.log(data)
            if (data != null) {
                FindInformacionVentaVendedor(data.Context.Sequence)
                $("#SeccionVendedor").hide();
            }
        });
    }

    $('#DelAl').daterangepicker({

        locale: {
            cancelLabel: 'Clear',
            daysOfWeek: [
                "Do",
                "Lu",
                "Ma",
                "Mi",
                "Ju",
                "Vi",
                "Sa"
            ],
            monthNames: [
                 "Enero",
                 "Febrero",
                 "Marzo",
                 "Abril",
                 "Mayo",
                 "Junio",
                 "Julio",
                 "Agosto",
                 "Septiembre",
                 "Octubre",
                 "Noviembre",
                 "Deciembre"
            ]
        }

    });

    $("#FCF").click(function () {
        var drp = $('#DelAl').data('daterangepicker');
        var Del = drp.startDate.format('YYYY/MM/DD');
        var Al = drp.endDate.format('YYYY/MM/DD');

        $.confirm({
            title: '¡Confirmar!',
            content: 'Descargar el archivo podría tomar algunos segundos.',
            type: 'blue',
            buttons: {
                confirm: {
                    text: 'Confirmar',
                    action: function () {
                        $('#VendedorWait').show();
                        $.post('@Url.Action("VentaFCF", "Venta")', {
                            Del: Del,
                            Al: Al
                        }, function (data) {
                            console.log(data)
                            window.location.href = '@Url.Action("Download", "Clientes")' + '?fileGuid=' + data.FileGuid + '&fileName=' + data.FileName;
                            $('#VendedorWait').hide();
                        });
                    }
                },
                cancel: {
                    text: 'Cancelar',
                    action: function () {
                        $.alert('El proceso ha sido cancelado')
                    }
                }
            }
        });
    });
    $("#AgenteFCF").click(function () {
        var drp = $('#DelAl').data('daterangepicker');
        var Del = drp.startDate.format('YYYY/MM/DD');
        var Al = drp.endDate.format('YYYY/MM/DD');

        $.confirm({
            title: '¡Confirmar!',
            content: 'Descargar el archivo podría tomar algunos segundos.',
            type: 'blue',
            buttons: {
                confirm: {
                    text: 'Confirmar',
                    action: function () {
                        $('#VendedorWait').show();
                        $.post('@Url.Action("VentaAgenteFCF", "Venta")', {
                            Del: Del,
                            Al: Al
                        }, function (data) {
                            console.log(data)
                            window.location.href = '@Url.Action("Download", "Clientes")' + '?fileGuid=' + data.FileGuid + '&fileName=' + data.FileName;
                            $('#VendedorWait').hide();
                        });
                    }
                },
                cancel: {
                    text: 'Cancelar',
                    action: function () {
                        $.alert('El proceso ha sido cancelado')
                    }
                }
            }
        });
    });

    $("#AnalisisCompartivo").click(function () {
        var drp = $('#DelAl').data('daterangepicker');
        var Del = drp.startDate.format('YYYY/MM/DD');
        var Al = drp.endDate.format('YYYY/MM/DD');

        $.confirm({
            title: '¡Confirmar!',
            content: 'Descargar el archivo podría tomar algunos segundos.',
            type: 'blue',
            buttons: {
                confirm: {
                    text: 'Confirmar',
                    action: function () {
                        $('#VendedorWait').show();
                        $.post('@Url.Action("AnalisisComparativoCliente", "Venta")', {
                            Del: Del,
                            Al: Al
                        }, function (data) {
                            console.log(data)
                            window.location.href = '@Url.Action("Download", "Clientes")' + '?fileGuid=' + data.FileGuid + '&fileName=' + data.FileName;
                            $('#VendedorWait').hide();
                        });
                    }
                },
                cancel: {
                    text: 'Cancelar',
                    action: function () {
                        $.alert('El proceso ha sido cancelado')
                    }
                }
            }
        });
    });


    $("#Vendedor").on('keyup', function (e) {
        FindVendedor();
    });
    $('#Clientes').DataTable();
    $('#TablaMonto').DataTable();
    $('#TablaEstado').DataTable();
    $('#TablaCiudad').DataTable();

    function CambiarOperacion() {
        //console.log("Si");
        var tipo = 0;
        tipo = $("#TipoOperacion2").val();
        var Id = $("#SequenceVendedor").val();

        var VP1 = $('#TablaMonto').DataTable();
        VP1.destroy();
        var VP2 = $('#TablaEstado').DataTable();
        VP2.destroy();
        var VP3 = $('#TablaCiudad').DataTable();
        VP3.destroy();

        if (tipo == 1) {
            console.log("Si 1 " + Id);
            $("#MontoPorCliente").html('');
            $("#MontoPorEstado").html('');
            $("#MontoPorCiudad").html('');
            $("#MontoPorClienteHead").html('');
            $("#MontoPorEstadoHead").html('');
            $("#MontoPorCiudadHead").html('');
            $("#MontoPorClienteHead").append('<tr><th>Ranking</th><th>Nombre</th><th>Factura Anterior</th><th>Carta Factura Anterior</th><th>Factura</th><th>Carta Factura</th><th>Total</th></tr>');
            $("#MontoPorEstadoHead").append('<tr><th>Ranking</th><th>Nombre</th><th>Factura Anterior</th><th>Carta Factura Anterior</th><th>Factura</th><th>Carta Factura</th><th>Total</th></tr>');
            $("#MontoPorCiudadHead").append('<tr><th>Ranking</th><th>Nombre</th><th>Factura Anterior</th><th>Carta Factura Anterior</th><th>Factura</th> <th>Carta Factura</th><th>Total</th></tr>');

            FindInformacionVentaVendedorMonto(Id);

        } else if (tipo == 2) {
            console.log("Si 2 " + Id);
            $("#MontoPorCliente").html('');
            $("#MontoPorEstado").html('');
            $("#MontoPorCiudad").html('');
            $("#MontoPorClienteHead").html('');
            $("#MontoPorEstadoHead").html('');
            $("#MontoPorCiudadHead").html('');
            $("#MontoPorClienteHead").append('<tr><th>Ranking</th><th>Nombre</th><th>Cantidad Anterior</th><th>Cantidad</th></tr>');
            $("#MontoPorEstadoHead").append('<tr><th>Ranking</th><th>Nombre</th><th>Cantidad Anterior</th><th>Cantidad</th></tr>');
            $("#MontoPorCiudadHead").append('<tr><th>Ranking</th><th>Nombre</th><th>Cantidad Anterior</th><th>Cantidad</th></tr>');

            FindInformacionVentaVendedorPiezas(Id);
        } else if (tipo == 3) {
            console.log("Si 3 " + Id);
            $("#MontoPorCliente").html('');
            $("#MontoPorEstado").html('');
            $("#MontoPorCiudad").html('');
            $("#MontoPorClienteHead").html('');
            $("#MontoPorEstadoHead").html('');
            $("#MontoPorCiudadHead").html('');
            $("#MontoPorClienteHead").append('<tr><th>Ranking</th><th>Nombre</th><th>Cantidad Anterior</th><th>Cantidad</th></tr>');
            $("#MontoPorEstadoHead").append('<tr><th>Ranking</th><th>Nombre</th><th>Cantidad Anterior</th><th>Cantidad</th></tr>');
            $("#MontoPorCiudadHead").append('<tr><th>Ranking</th><th>Nombre</th><th>Cantidad Anterior</th><th>Cantidad</th></tr>');
            FindInformacionVentaVendedorOferta(Id);
        }

    };

    function FindVendedor() {
        $.post('@Url.Action("BuscarVendedor", "Evaluacion")', {
            Vendedor: $("#Vendedor").val()
        }, function (data) {
            $("#content").html('');

            if (data != null && $.isArray(data.Context)) {
                $.each(data.Context, function (index, value) {
                    $("#content").append("<tr><td class='hidden'>" + value.Sequence + "</td><td>" + value.Nombre + "</td><td><div onclick='FindInformacionVentaVendedor(" + value.Sequence + ")' class='btn btn-info'><span class='glyphicon glyphicon-eye-open'></span> Detalles</div></td></tr>");

                });
            } else {
                $.alert("Ocurrio un error al procesar la solicitud");
            }
        });
    }

    function FindInformacionClientes(Sequence) {
        $.post('@Url.Action("InformacionClientes", "Venta")', {
            Sequence: Sequence
        }, function (data) {
            if (data != null) {
                var i = 0;
                if ($.isArray(data.Context.Clientes)) {
                    var VP = $('#Clientes').DataTable();
                    VP.destroy();
                    $("#ClientesDetalle").html('');
                    i = 1;
                    $.each(data.Context.Clientes, function (index, value) {
                        var En80 = 'NO'
                        if (value.En8020 == 'Y') {
                            En80 = 'SI'
                        }
                        $("#ClientesDetalle").append('<tr>\
                                                        <th>'+ i + '</th>\
                                                        <th>' + value.Codigo + '</th>\
                                                        <th>' + value.Nombre + '</th>\
                                                        <th>' + En80 + '</th>\
                                                        <th>' + value.Estado + '</th>\
                                                        <th>' + value.Ciudad + '</th>\
                                                        <th>' + formatNumber.new(value.Monto.toFixed(2), "$") + '</th>\
                                                    </tr>');
                        i++
                    });
                }
                $('#Clientes').DataTable({
                    "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]],
                    "paging": true,
                    "lengthChange": true,
                    "searching": true,
                    "ordering": true,
                    "info": true,
                    "autoWidth": true,
                    "language": {
                        "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json"
                    }
                });
            } else {
                $.alert("Ocurrio un error al procesar la solicitud");
            }
        });
    };

    function FindInformacionVentaVendedor(Sequence) {

        FindInformacionClientes(Sequence);
        $("#SequenceVendedor").val(Sequence);
        $("#MontoPorCliente").html('');
        $("#MontoPorEstado").html('');
        $("#MontoPorCiudad").html('');

        $("#MontoPorClienteHead").html('');
        $("#MontoPorEstadoHead").html('');
        $("#MontoPorCiudadHead").html('');

        $("#MontoPorClienteHead").append('<tr>\
                                            <th>Ranking</th>\
                                            <th>Nombre</th>\
                                            <th>Factura Anterior</th>\
                                            <th>Carta Factura Anterior</th>\
                                            <th>Factura</th>\
                                            <th>Carta Factura</th>\
                                            <th>Total</th>\
                                        </tr>');
        $("#MontoPorEstadoHead").append('<tr>\
                                            <th>Ranking</th>\
                                            <th>Nombre</th>\
                                            <th>Factura Anterior</th>\
                                            <th>Carta Factura Anterior</th>\
                                            <th>Factura</th>\
                                            <th>Carta Factura</th>\
                                            <th>Total</th>\
                                        </tr>');
        $("#MontoPorCiudadHead").append('<tr>\
                                            <th>Ranking</th>\
                                            <th>Nombre</th>\
                                            <th>Factura Anterior</th>\
                                            <th>Carta Factura Anterior</th>\
                                            <th>Factura</th>\
                                            <th>Carta Factura</th>\
                                            <th>Total</th>\
                                        </tr>');
        $("#VF").html('0');
        $("#CF").html('0');
        $("#Total").html('0');
        $("#Cumpliento").html('0 %');
        $("#Ranking").html('0');
        $("#Meta").html('0');
        $("#ImgVendedor").attr("src", "")
        $("#NombreVendedor").html('');
        $.post('@Url.Action("InformacionVentas", "Venta")', {
            Sequence: Sequence
        }, function (data) {
            if (data != null) {
                console.log(data);
                //var VP1 = $('#TablaMonto').DataTable();
                //VP1.destroy();
                //var VP2 = $('#TablaEstado').DataTable();
                //VP2.destroy();
                //var VP3 = $('#TablaCiudad').DataTable();
                //VP3.destroy();

                $("#NombreVendedor").html(data.Context.Nombre);
                $("#Meta").html(formatNumber.new(data.Context.Meta.toFixed(2), "$"));
                $("#MetaAnioAnterior").html(formatNumber.new(data.Context.MetaAnioAnterior.toFixed(2), "$"));
                $("#CartaFactura").html(formatNumber.new(data.Context.CartaFactura.toFixed(2), "$"));
                $("#Factura").html(formatNumber.new(data.Context.Factura.toFixed(2), "$"));
                $("#CartaFacturaAñoPasado").html(formatNumber.new(data.Context.CartaFacturaAñoPasado.toFixed(2), "$"));
                $("#FacturaAñoPasado").html(formatNumber.new(data.Context.FacturaAñoPasado.toFixed(2), "$"));
                $("#TotalActual").html(formatNumber.new((data.Context.CartaFactura + data.Context.Factura).toFixed(2), "$"));
                $("#TotalAnterior").html(formatNumber.new((data.Context.CartaFacturaAñoPasado + data.Context.FacturaAñoPasado).toFixed(2), "$"));
                $("#NoPedidosActuales").html(data.Context.NoPedidosActuales);
                $("#NoPedidosAnteriores").html(data.Context.NoPedidosAnteriores);
                $("#PromedioPorPedidoActual").html(formatNumber.new(data.Context.PromedioPorPedidoActual.toFixed(2), "$"));
                $("#PromedioPorPedidoAnterior").html(formatNumber.new(data.Context.PromedioPorPedidoAnterior.toFixed(2), "$"));
                $("#NoClientesActuales").html(data.Context.NoClientesActuales);
                $("#NoClientesAnteriores").html(data.Context.NoClientesAnteriores);
                $("#PromedioMontoPorClienteActual").html(formatNumber.new(data.Context.PromedioMontoPorClienteActual.toFixed(2), "$"));
                $("#PromedioMontoPorClienteAnterior").html(formatNumber.new(data.Context.PromedioMontoPorClienteAnterior.toFixed(2), "$"));

                //$("#VF").html(formatNumber.new(data.Context.F.toFixed(2), "$"));
                //$("#CF").html(formatNumber.new(data.Context.CF.toFixed(2), "$"));
                //$("#Total").html(formatNumber.new(data.Context.Total.toFixed(2), "$"));
                //$("#Cumpliento").html(formatNumber.new(data.Context.Cumplimiento.toFixed(2), "") + ' %');
                //$("#Meta").html(formatNumber.new(data.Context.Meta.toFixed(2), "$"));
                //$("#Ranking").html(formatNumber.new(data.Context.Ranking, "") + '');
                $("#ImgVendedor").attr("src", "http://192.168.2.188/Imagenes/Vendedores/" + Sequence + ".jpg")
                //var i = 0;
                //if ($.isArray(data.Context.AgrupadoClientes)) {
                //    i = 1;
                //    $.each(data.Context.AgrupadoClientes, function (index, value) {
                //        $("#MontoPorCliente").append("<tr><td>" + i + "</td><td>" + value.Cliente + "</td><td>" + formatNumber.new(value.FacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Factura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFactura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Total.toFixed(2), "$") + "</td></tr>");
                //        i++
                //    });
                //}
                //if ($.isArray(data.Context.AgrupadoEstado)) {
                //    i = 1;
                //    $.each(data.Context.AgrupadoEstado, function (index, value) {
                //        $("#MontoPorEstado").append("<tr><td>" + i + "</td><td>" + value.Estado + "</td><td>" + formatNumber.new(value.FacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Factura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFactura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Total.toFixed(2), "$") + "</td></tr>");
                //        i++
                //    });
                //}
                //if ($.isArray(data.Context.AgrupadoCiudad)) {
                //    i = 1;
                //    $.each(data.Context.AgrupadoCiudad, function (index, value) {
                //        $("#MontoPorCiudad").append("<tr><td>" + i + "</td><td>" + value.Ciudad + "</td><td>" + formatNumber.new(value.FacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Factura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFactura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Total.toFixed(2), "$") + "</td></tr>");
                //        i++
                //    });
                //}

                //$('#TablaMonto').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });
                //$('#TablaEstado').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });
                //$('#TablaCiudad').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });
            } else {
                $.alert("Ocurrio un error al procesar la solicitud");
            }
        });
    }
    function FindInformacionVentaVendedorMonto(Sequence) {
        $.post('@Url.Action("InformacionVentas", "Venta")', {
            Sequence: Sequence
        }, function (data) {
            if (data != null) {
                console.log(data)
                var i = 0;
                if ($.isArray(data.Context.AgrupadoClientes)) {
                    i = 1;
                    $.each(data.Context.AgrupadoClientes, function (index, value) {
                        $("#MontoPorCliente").append("<tr><td>" + i + "</td><td>" + value.Cliente + "</td><td>" + formatNumber.new(value.FacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Factura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFactura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Total.toFixed(2), "$") + "</td></tr>");
                        i++
                    });
                }
                if ($.isArray(data.Context.AgrupadoEstado)) {
                    i = 1;
                    $.each(data.Context.AgrupadoEstado, function (index, value) {
                        $("#MontoPorEstado").append("<tr><td>" + i + "</td><td>" + value.Estado + "</td><td>" + formatNumber.new(value.FacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Factura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFactura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Total.toFixed(2), "$") + "</td></tr>");
                        i++
                    });
                }
                if ($.isArray(data.Context.AgrupadoCiudad)) {
                    i = 1;
                    $.each(data.Context.AgrupadoCiudad, function (index, value) {
                        $("#MontoPorCiudad").append("<tr><td>" + i + "</td><td>" + value.Ciudad + "</td><td>" + formatNumber.new(value.FacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFacturaAñoPasado.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Factura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.CartaFactura.toFixed(2), "$") + "</td><td>" + formatNumber.new(value.Total.toFixed(2), "$") + "</td></tr>");
                        i++
                    });
                }
                $('#TablaMonto').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });
                $('#TablaEstado').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });
                $('#TablaCiudad').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });

            } else {
                $.alert("Ocurrio un error al procesar la solicitud");
            }
        });
    }
    function FindInformacionVentaVendedorPiezas(Sequence) {


        $.post('@Url.Action("InformacionVentasPiezas", "Venta")', {
            Sequence: Sequence
        }, function (data) {
            if (data != null) {
                console.log(data)
                var i = 0;
                if ($.isArray(data.Context.AgrupadoClientes)) {
                    i = 1;
                    $.each(data.Context.AgrupadoClientes, function (index, value) {
                        $("#MontoPorCliente").append("<tr><td>" + i + "</td><td>" + value.Cliente + "</td><td>" + formatNumber.new(value.CantidadAnterior.toFixed(2), "") + "</td><td>" + formatNumber.new(value.Cantidad.toFixed(2), "") + "</td></tr>");
                        i++
                    });
                }
                if ($.isArray(data.Context.AgrupadoEstado)) {
                    i = 1;
                    $.each(data.Context.AgrupadoEstado, function (index, value) {
                        $("#MontoPorEstado").append("<tr><td>" + i + "</td><td>" + value.Estado + "</td><td>" + formatNumber.new(value.CantidadAnterior.toFixed(2), "") + "</td><td>" + formatNumber.new(value.Cantidad.toFixed(2), "") + "</td></tr>");
                        i++
                    });
                }
                if ($.isArray(data.Context.AgrupadoCiudad)) {
                    i = 1;
                    $.each(data.Context.AgrupadoCiudad, function (index, value) {
                        $("#MontoPorCiudad").append("<tr><td>" + i + "</td><td>" + value.Ciudad + "</td><td>" + formatNumber.new(value.CantidadAnterior.toFixed(2), "") + "</td><td>" + formatNumber.new(value.Cantidad.toFixed(2), "") + "</td></tr>");
                        i++
                    });
                }
                $('#TablaMonto').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });
                $('#TablaEstado').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });
                $('#TablaCiudad').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });

            } else {
                $.alert("Ocurrio un error al procesar la solicitud");
            }
        });
    }
    function FindInformacionVentaVendedorOferta(Sequence) {

        $.post('@Url.Action("InformacionVentasOferta", "Venta")', {
            Sequence: Sequence
        }, function (data) {
            if (data != null) {
                console.log(data)
                var i = 0;
                if ($.isArray(data.Context.AgrupadoClientes)) {
                    i = 1;
                    $.each(data.Context.AgrupadoClientes, function (index, value) {
                        $("#MontoPorCliente").append("<tr><td>" + i + "</td><td>" + value.Cliente + "</td><td>" + formatNumber.new(value.CantidadAnterior.toFixed(2), "") + "</td><td>" + formatNumber.new(value.Cantidad.toFixed(2), "") + "</td></tr>");
                        i++
                    });
                }
                if ($.isArray(data.Context.AgrupadoEstado)) {
                    i = 1;
                    $.each(data.Context.AgrupadoEstado, function (index, value) {
                        $("#MontoPorEstado").append("<tr><td>" + i + "</td><td>" + value.Estado + "</td><td>" + formatNumber.new(value.CantidadAnterior.toFixed(2), "") + "</td><td>" + formatNumber.new(value.Cantidad.toFixed(2), "") + "</td></tr>");
                        i++
                    });
                }
                if ($.isArray(data.Context.AgrupadoCiudad)) {
                    i = 1;
                    $.each(data.Context.AgrupadoCiudad, function (index, value) {
                        $("#MontoPorCiudad").append("<tr><td>" + i + "</td><td>" + value.Ciudad + "</td><td>" + formatNumber.new(value.CantidadAnterior.toFixed(2), "") + "</td><td>" + formatNumber.new(value.Cantidad.toFixed(2), "") + "</td></tr>");
                        i++
                    });
                }
                $('#TablaMonto').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });
                $('#TablaEstado').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });
                $('#TablaCiudad').DataTable({ "lengthMenu": [[15, 30, 45, -1], [15, 30, 45, "All"]], "paging": true, "lengthChange": true, "searching": true, "ordering": true, "info": true, "autoWidth": true, "language": { "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/Spanish.json" } });

            } else {
                $.alert("Ocurrio un error al procesar la solicitud");
            }
        });
    }

</script>

<script>
    var formatNumber = {
        separador: ",", // separador para los miles
        sepDecimal: '.', // separador para los decimales
        formatear: function (num) {
            num += '';
            var splitStr = num.split('.');
            var splitLeft = splitStr[0];
            var splitRight = splitStr.length > 1 ? this.sepDecimal + splitStr[1] : '';
            var regx = /(\d+)(\d{3})/;
            while (regx.test(splitLeft)) {
                splitLeft = splitLeft.replace(regx, '$1' + this.separador + '$2');
            }
            return this.simbol + splitLeft + splitRight;
        },
        new: function (num, simbol) {
            this.simbol = simbol || '';
            return this.formatear(num);
        }
    }
</script>
